\documentclass[11pt]{article}

% AMS Packages
\usepackage{amsmath} 
\usepackage{amssymb} 
\usepackage{amsthm}
% Page dimensions
\usepackage[margin=1in]{geometry}
% Images
\usepackage[pdftex]{graphicx} 
% Enumerate package
\usepackage{enumitem} 
\usepackage{array} 
% Fancify pages
\usepackage{fancyhdr} 
% Convert captions on figures to bold font
\usepackage[labelfont=bf,textfont=md]{caption}
% Time New Roman font
\usepackage{times}
% SI Units in math type
\usepackage{siunitx}
\usepackage{textcomp} 
% Change sizes of sections
\usepackage{titlesec}
\titleformat{\section}{\normalfont\large\bfseries}{\thesection}{1em}{}
\titleformat{\subsection}{\normalfont\bfseries}{\thesubsection}{1em}{}
\titleformat{\subsubsection}{\normalfont\small\bfseries}{\thesubsubsection}{1em}{}
% Declare useful math operators
\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator*{\plim}{plim}
\DeclareMathOperator{\Tr}{Tr}


\begin{document}

\section{Mutual Information}

Recall that the output of the $i$th neuron can be written as 
\begin{align}
	r_i &= g_i(\ell_i) \\
	&= g_i(v_i s + \sigma_I w_i \xi_I + \sigma_G\xi_i).
\end{align}
Ultimately, we want $I[s, \mathbf{r}]$. For now, we will focus on $I[s, \boldsymbol{\ell}]$ and note that $I[s,\mathbf{r}] \leq I[s, \boldsymbol{\ell}]$ by the data processing inequality. To calculate the mutual information, we must first calculate $P[\boldsymbol{\ell}|s]$. We can do this via marginalization:
\begin{align}
	P[\boldsymbol{\ell}|s] &= \int P[\boldsymbol{\ell}|s, \xi_I] P[\xi_I]d\xi_I \\
	&= \int d\xi_I  \frac{1}{\sqrt{2\pi}} \exp(-\xi_I^2/2) \prod_{i=1}^N P[\ell_i|s,\xi_I] \\
	&=  \frac{1}{\sqrt{2\pi}} \int d\xi_I   \exp(-\xi_I^2/2) \prod_{i=1}^N \frac{1}{\sqrt{2\pi \sigma_G^2}} \exp\left(-\frac{\left(\ell_i - (v_i s + \sigma_I w_i \xi_I)\right)^2}{2\sigma_G^2}\right) \\
	&= \frac{1}{(2\pi)^{(N+1)/2}\sigma_G^N} \int d\xi_I \exp(-\xi_I^2/2) \exp\left(-\frac{1}{2\sigma_G^2}\sum_{i=1}^N \left(\ell_i - (v_i s + \sigma_I w_i \xi_I)\right)^2\right) \\
	&= \frac{1}{(2\pi)^{(N+1)/2}\sigma_G^N} \int d\xi_I \exp(-\xi_I^2/2) \notag \\
	& \qquad \times \exp\left(-\frac{1}{2\sigma_G^2}\sum_{i=1}^N \ell_i^2 -2\ell_i (v_i s + \sigma_I w_i \xi_I) + (v_i s + \sigma_I w_i \xi_I)^2\right) \\
	&= \frac{1}{(2\pi)^{(N+1)/2}\sigma_G^N} \exp\left(-\frac{1}{2\sigma_G^2}\sum_{i=1}^N \ell_i^2\right)\exp\left(\frac{s}{\sigma_G^2}\sum_{i=1}^N \ell_i v_i \right)\exp\left(-\frac{1}{2\sigma_G^2}s^2 \left\{v\right\}_2\right) \notag \\
	&\times \int d\xi_I\exp\left[-\frac{1}{2}\left(1+\frac{\sigma_I^2}{\sigma_G^2} \left\{w\right\}_2\right)\xi_I^2 +\frac{\sigma_I}{\sigma_G^2}\left( \sum_{i=1}^N \ell_i w_i - s \left\{v,w\right\}_{1,1}\right)\xi_I \right] \\
	&=  \frac{1}{(2\pi)^{(N+1)/2}\sigma_G^N}\exp\left(-\frac{1}{2\sigma_G^2}\sum_{i=1}^N \ell_i^2\right)\exp\left(\frac{s}{\sigma_G^2}\sum_{i=1}^N \ell_i v_i \right)\exp\left(-\frac{1}{2\sigma_G^2}s^2 \left\{v\right\}_2\right) \notag \\
	&\qquad \times \frac{\sqrt{2\pi \sigma_G^2}}{\sqrt{\sigma_G^2 + \sigma_I^2 \left\{w\right\}_2}}\exp\left[\frac{\sigma_I^2\left(\displaystyle\sum_{i=1}^N \ell_i w_i - s  \left\{v,w\right\}_{1,1}\right)^2}{2 \sigma_G^2 (\sigma_G^2 + \sigma_I^2 \left\{w\right\}_2)}\right] \\
	&= \frac{1}{\sigma_G^{N-1}\sqrt{(2\pi)^N(\sigma_G^2 + \sigma_I^2 \left\{w\right\}_2)}}\exp\left(-\frac{1}{2\sigma_G^2}\left\{\ell \right\}_2\right)\exp\left(\frac{1}{\sigma_G^2} s\left\{\ell, v\right\}_{1,1}\right) \notag \\
	&\qquad \times \exp\left(-\frac{1}{2\sigma_G^2}s^2 \left\{v\right\}_2\right)\exp\left[\frac{\sigma_I^2\left(\left\{\ell, w\right\}_{1,1} - s  \left\{v,w\right\}_{1,1}\right)^2}{2\sigma_G^2 (\sigma_G^2 + \sigma_I^2 \left\{w\right\}_2)}\right].
\end{align}
Next, we must calculate $P[\boldsymbol{\ell}]$. This is doable also by marginalization:
\begin{align}
	P[\boldsymbol{\ell}] &= \int ds P[\boldsymbol{\ell}|s] P[s] \\
	&= \frac{\exp\left(-\frac{1}{2\sigma_G^2}\left\{\ell \right\}_2\right)}{\sigma_G^{N-1}\sqrt{(2\pi)^N(\sigma_G^2 + \sigma_I^2 \left\{w\right\}_2)}} \int ds \exp\left(\frac{1}{\sigma_G^2} s\left\{\ell, v\right\}_{1,1}\right) \\
	&\times \exp\left[\frac{\sigma_I^2\left(\left\{\ell, w\right\}_{1,1} - s \left\{v,w\right\}_{1,1}\right)^2}{2\sigma_G^2 (\sigma_G^2 + \sigma_I^2 \left\{w\right\}_2)}\right]\exp\left(-\frac{1}{2\sigma_G^2}s^2 \left\{v\right\}_2\right)\times \frac{1}{\sqrt{2\pi \sigma_S^2}} \exp\left(-\frac{s^2}{2\sigma_S^2}\right) \\
	&= \frac{1}{\sigma_G^{N-2}\sqrt{(2\pi)^N \kappa}}  \exp\left(-\frac{\left\{\ell \right\}_2}{2\sigma_G^2}\right) \exp\left( \frac{\sigma_I^2(\sigma_G^2 + \sigma_S^2 \left\{v\right\}_2)}{2 \sigma_G^2 \kappa} \left\{\ell, w\right\}_{1,1}^2\right) \notag \\
	& \times \exp\left(-\frac{\sigma_I^2 \sigma_S^2\left\{v,w\right\}_{1,1}}{\sigma_G^2\kappa} \left\{\ell, w\right\}_{1,1} \left\{\ell, v\right\}_{1,1} \right) \exp\left(\frac{\sigma_S^2 (\sigma_G^2 + \sigma_I^2 \left\{w\right\}_2)}{2 \sigma_G^2 \kappa} \left\{\ell, v\right\}_{1,1}^2\right),
\end{align}
where 
\begin{align}
	\kappa &= \left(\sigma_G^2 + \sigma_I^2 \left\{w\right\}_2\right)\left(\sigma_G^2 + \sigma_S^2 \left\{v\right\}_2\right) - \sigma_I^2 \sigma_S^2 \left\{v,w\right\}_{1,1}^2.
\end{align}
The mutual information is 
\begin{align}
	I[s,\boldsymbol{\ell}] &= \int d\boldsymbol{\ell} ds P[s] P[\boldsymbol{\ell}|s] \log \frac{P[\boldsymbol{\ell}|s]}{P[\boldsymbol{\ell}]}.
\end{align}
First, we can see that 
\begin{align}
 \frac{P[\boldsymbol{\ell}|s]}{P[\boldsymbol{\ell}]} &= \frac{1}{\sigma_G} \sqrt{\frac{\kappa}{\sigma_G^2 + \sigma_I^2 \left\{w\right\}_2}}\exp\left(\frac{s}{\sigma_G^2} \left\{\ell, v\right\}_{1,1}\right) \exp\left(- \frac{s \sigma_I^2 \left\{v,w\right\}_{1,1}}{ \sigma_G^2 (\sigma_G^2 + \sigma_I^2 \left\{w\right\}_2)} \left\{\ell, w\right\}_{1,1}\right) \notag \\
 \times &\exp\left(-\frac{s^2}{2\sigma_G^2} \left\{v\right\}_2\right) \exp\left(\frac{s^2 \sigma_I^2 \left\{v,w\right\}_{1,1}^2}{2 \sigma_G^2 (\sigma_G^2 + \sigma_I^2 \left\{w\right\}_2)}\right) \notag \\
 \times & \exp\left( -\frac{\sigma_I^4 \sigma_S^2 \left\{v,w\right\}_{1,1}^2}{2 \sigma_G^2(\sigma_G^2 + \sigma_I^2 \left\{w\right\}_2) \kappa} \left\{\ell, w\right\}_{1,1}^2\right)\exp\left(\frac{\sigma_I^2 \sigma_S^2\left\{v,w\right\}_{1,1}}{\sigma_G^2\kappa} \left\{\ell, w\right\}_{1,1} \left\{\ell, v\right\}_{1,1} \right)  \notag \\
 \times & \exp\left(-\frac{\sigma_S^2 (\sigma_G^2 + \sigma_I^2 \left\{w\right\}_2)}{2 \sigma_G^2 \kappa} \left\{\ell, v\right\}_{1,1}^2\right)
\end{align}
Thus, the mutual information consists of three terms
\begin{align}
	I[s, \boldsymbol{\ell}] &= I_1 + I_2 + I_3
\end{align}
where
\begin{align}
	I_1 &= \int d\boldsymbol{\ell} ds P[s] P[\boldsymbol{\ell}|s] \log \frac{1}{\sigma_G} \sqrt{\frac{\kappa}{\sigma_G^2 + \sigma_I^2 \left\{w\right\}_2}} = \log \frac{1}{\sigma_G} \sqrt{\frac{\kappa}{\sigma_G^2 + \sigma_I^2 \left\{w\right\}_2}},
\end{align}
\begin{align}
	I_2 &= \int d\boldsymbol{\ell} ds P[s] P[\boldsymbol{\ell}|s] \left(-\frac{\sigma_I^4 \sigma_S^2 \left\{v,w\right\}_{1,1}^2}{2 \sigma_G^2(\sigma_G^2 + \sigma_I^2 \left\{w\right\}_2) \kappa} \left\{\ell, w\right\}_{1,1}^2 + \frac{\sigma_I^2 \sigma_S^2\left\{v,w\right\}_{1,1}}{\sigma_G^2\kappa} \left\{\ell, w\right\}_{1,1} \left\{\ell, v\right\}_{1,1}\right. \notag \\
	&\left. \qquad \qquad \qquad \qquad \qquad  -\frac{\sigma_S^2 (\sigma_G^2 + \sigma_I^2 \left\{w\right\}_2)}{2 \sigma_G^2 \kappa} \left\{\ell, v\right\}_{1,1}^2 \right) \\
	&= \int d\boldsymbol{\ell} P[\boldsymbol{\ell}] \left(-\frac{\sigma_I^4 \sigma_S^2 \left\{v,w\right\}_{1,1}^2}{2 \sigma_G^2(\sigma_G^2 + \sigma_I^2 \left\{w\right\}_2) \kappa} \left\{\ell, w\right\}_{1,1}^2 + \frac{\sigma_I^2 \sigma_S^2\left\{v,w\right\}_{1,1}}{\sigma_G^2\kappa} \left\{\ell, w\right\}_{1,1} \left\{\ell, v\right\}_{1,1}\right. \notag \\
	&\left. \qquad \qquad \qquad \qquad \qquad  -\frac{\sigma_S^2 (\sigma_G^2 + \sigma_I^2 \left\{w\right\}_2)}{2 \sigma_G^2 \kappa} \left\{\ell, v\right\}_{1,1}^2 \right),
\end{align}
and lastly 
\begin{align}
	I_3 &= \int d\boldsymbol{\ell} \int ds P[s] P[\boldsymbol{\ell}|s] \left(\frac{s}{\sigma_G^2} \left\{\ell, v\right\}_{1,1} - \frac{s \sigma_I^2 \left\{v,w\right\}_{1,1}}{\sigma_G^2 (\sigma_G^2 + \sigma_I^2 \left\{w\right\}_2)}\left\{\ell, w\right\}_{1,1} - \frac{s^2}{2\sigma_G^2} \left\{v\right\}_2 \right. \notag \\
	&\qquad  \qquad \qquad \qquad \qquad \left. + \frac{s^2 \sigma_I^2 \left\{v,w\right\}_{1,1}^2}{2\sigma_G^2 (\sigma_G^2 + \sigma_I^2 \left\{w\right\}_2)}\right).
\end{align}
Now, we turn to vector notation. Note that 
\begin{align}
\left\{v\right\}_2 &= ||\mathbf{v}||^2 \\
\left\{w\right\}_2 &= ||\mathbf{w}||^2 \\
\left\{v,w\right\}_{1,1} &= \mathbf{v}\cdot \mathbf{w}\\
\left\{\ell, w\right\}_{1,1}^2 &= \sum_{i,j} \ell_i \ell_j w_i w_j = \boldsymbol{\ell}^T \mathbf{ww}^T \boldsymbol{\ell} \\
\left\{\ell, v\right\}_{1,1}^2 &= \sum_{i,j} \ell_i \ell_j  v_i v_j = \boldsymbol{\ell}^T \mathbf{vv}^T \boldsymbol{\ell} \\
\left\{\ell, v\right\}_{1,1} \left\{\ell,w\right\}_{1,1}&= \sum_{i,j} \ell_i \ell_j v_i w_j= \boldsymbol{\ell}^T \mathbf{vw}^T \boldsymbol{\ell} = \boldsymbol{\ell}^T \mathbf{w}\mathbf{v}^T \boldsymbol{\ell}
\end{align}
The easiest term is $I_1$:
\begin{align}
	I_1 &= \log \frac{1}{\sigma_G} \sqrt{\frac{\kappa}{\sigma_G^2 + \sigma_I^2 ||\mathbf{w}||^2}},\\
	\kappa &= (\sigma_G^2 + \sigma_I^2 ||\mathbf{w}||^2)(\sigma_G^2 + \sigma_S^2 ||\mathbf{v}||^2) - \sigma_I^2 \sigma_S^2 (\mathbf{v}\cdot\mathbf{w})^2.
\end{align}
Next, we write $P[\boldsymbol{\ell}]$ as 
\begin{align}
	P[\boldsymbol{\ell}] &= \frac{1}{\sigma_G^{N-2}\sqrt{(2\pi)^N \kappa}} \exp\left(- \boldsymbol{\ell}^T \mathbf{A} \boldsymbol{\ell}\right), 
\end{align}
where 
\begin{align}
	\mathbf{A} &= \frac{1}{2\sigma_G^2}\mathbf{I} - \frac{\sigma_I^2(\sigma_G^2 +\sigma_S^2 ||\mathbf{v}||^2)}{2\sigma_G^2 \kappa} \mathbf{ww}^T+ \frac{\sigma_I^2 \sigma_S^2 (\mathbf{v}\cdot \mathbf{w})}{\sigma_G^2 \kappa} \mathbf{wv}^T - \frac{\sigma_S^2 (\sigma_G^2 + \sigma_I^2 ||\mathbf{w}||^2)}{2\sigma_G^2 \kappa} \mathbf{vv}^T.
\end{align}
Thus, we can write $I_2$ as 
\begin{align}
	I_2 &= \frac{1}{\sigma_G^{N-2}\sqrt{(2\pi)^N \kappa}}\int d\boldsymbol{\ell} (\boldsymbol{\ell}^T \mathbf{B} \boldsymbol{\ell}) \exp(-\boldsymbol{\ell}^T \mathbf{A} \boldsymbol{\ell})
\end{align}
where 
\begin{align}
	\mathbf{B} &= - \frac{\sigma_I^4 \sigma_S^2 (\mathbf{v}\cdot \mathbf{w})^2}{2 \sigma_G^2 \kappa(\sigma_G^2 + \sigma_I^2 ||\mathbf{w}||^2)} \mathbf{ww}^T+ \frac{\sigma_I^2 \sigma_S^2 (\mathbf{v}\cdot \mathbf{w})}{\sigma_G^2 \kappa} \mathbf{wv}^T - \frac{\sigma_S^2(\sigma_G^2 + \sigma_I^2 ||\mathbf{w}||^2)}{2 \sigma_G^2 \kappa} \mathbf{vv}^T. \\
	&= \frac{1}{2\sigma_G^2} \left(B_1 \mathbf{ww}^T + A_2 \mathbf{wv}^T + A_3 \mathbf{vv}^T\right).
\end{align}

To evaluate this integral we utilize the following identity
\begin{align}
\int d\boldsymbol{\ell} \left(C_0 +\boldsymbol{\ell}^T \mathbf{C}_1 \boldsymbol{\ell}\right)\exp\left(\boldsymbol{\ell}^T \mathbf{C}_2 \boldsymbol{\ell}\right) = \sqrt{\frac{\pi^N}{\det \mathbf{C}_2}}\left(C_0 + \Tr\left(\mathbf{C}_1\mathbf{C}_2^{-1}\right)\right)
\end{align}
so that
\begin{align}
	I_2 &= \frac{1}{\sigma_G^{N-2}\sqrt{(2\pi)^N \kappa}} \sqrt{\frac{\pi^N}{\det \mathbf{A}}} \Tr(\mathbf{B} \mathbf{A}^{-1}) \\
	&= \frac{1}{\sigma_G^{N-2} \sqrt{2^N \kappa \det \mathbf{A}}}\Tr(\mathbf{B} \mathbf{A}^{-1}).
\end{align}
We turn to the last integral. For this one, we must first perform the $s$ integration: 
\begin{align}
	&\frac{\exp\left(-\frac{1}{2\sigma_G^2}\left\{\ell \right\}_2\right)}{\sigma_G^{N-1}\sqrt{(2\pi)^N(\sigma_G^2 + \sigma_I^2 \left\{w\right\}_2)}} \int ds \exp\left(\frac{1}{\sigma_G^2} s\left\{\ell, v\right\}_{1,1}\right) \notag \\
	&\times \exp\left[\frac{\sigma_I^2\left(\left\{\ell, w\right\}_{1,1} - s \left\{v,w\right\}_{1,1}\right)^2}{2\sigma_G^2 (\sigma_G^2 + \sigma_I^2 \left\{w\right\}_2)}\right]\exp\left(-\frac{1}{2\sigma_G^2}s^2 \left\{v\right\}_2\right)\times \frac{1}{\sqrt{2\pi \sigma_S^2}} \exp\left(-\frac{s^2}{2\sigma_S^2}\right) \notag \\
	&\times \left(\frac{s}{\sigma_G^2} \left\{\ell, v\right\}_{1,1} - \frac{s \sigma_I^2 \left\{v,w\right\}_{1,1}}{\sigma_G^2 (\sigma_G^2 + \sigma_I^2 \left\{w\right\}_2)}\left\{\ell, w\right\}_{1,1} - \frac{s^2}{2\sigma_G^2} \left\{v\right\}_2   + \frac{s^2 \sigma_I^2 \left\{v,w\right\}_{1,1}^2}{2\sigma_G^2 (\sigma_G^2 + \sigma_I^2 \left\{w\right\}_2)}\right) \\
	&= -\frac{\sigma_S^2}{2(2\pi)^{N/2} \sigma_G^N \kappa^{5/2} (\sigma_G^2 + \sigma_I^2 ||\mathbf{w}||^2)}\int d\boldsymbol{\ell}(C + \boldsymbol{\ell}^T \mathbf{D} \boldsymbol{\ell})\exp(-\boldsymbol{\ell}^T \mathbf{A} \boldsymbol{\ell})
\end{align}
where
\begin{align}
	\mathbf{D} &= \gamma \left(-\sigma_I^4 (\mathbf{v}\cdot\mathbf{w})^2\mathbf{ww}^T+ 2\sigma_I^2 (\sigma_G^2 + \sigma_I^2 ||\mathbf{w}||^2)(\mathbf{v} \cdot \mathbf{w})\mathbf{wv}^T -(\sigma_G^2 + \sigma_I^2 ||\mathbf{w}||^2)^2 \mathbf{vv}^T\right),\\
	\gamma &= (2\sigma_G^2 + \sigma_S^2 ||\mathbf{v}||^2)(\sigma_G^2 + \sigma_I^2 ||\mathbf{w}||^2) - \sigma_I^2 \sigma_S^2 (\mathbf{v}\cdot \mathbf{w})^2.
\end{align}
Finally,
\begin{align}
	C &= \kappa \sigma_G^2 (\sigma_G^2 + \sigma_I^2 ||\mathbf{w}||^2)(\sigma_G^2 ||\mathbf{v}||^2 + \sigma_I^2(||\mathbf{v}||^2 ||\mathbf{w}||^2 - (\mathbf{v}\cdot \mathbf{w})^2)).
\end{align}
So, we can write $I_3$ as 
\begin{align}
	I_3 &= -\frac{\sigma_S^2}{2(2)^{N/2} \sigma_G^N \kappa^{5/2} (\sigma_G^2 + \sigma_I^2 ||\mathbf{w}||^2)}(\det \mathbf{A})^{-1/2} \left(C + \Tr (\mathbf{D}\mathbf{A}^{-1})\right).
\end{align}
The total mutual information is
\begin{align}
	I &= I_1 + I_2 + I_3 \\
	&= \log \frac{1}{\sigma_G} \sqrt{\frac{\kappa}{\sigma_G^2 + \sigma_I^2 ||\mathbf{w}||^2}} +\frac{1}{\sigma_G^{N-2} 2^{N/2} \sqrt{\kappa \det \mathbf{A}}}\Tr(\mathbf{B} \mathbf{A}^{-1}) \notag \\
	&\qquad \qquad -\frac{\sigma_S^2}{2(2)^{N/2} \sigma_G^N \kappa^{5/2} (\sigma_G^2 + \sigma_I^2 ||\mathbf{w}||^2)}(\det \mathbf{A})^{-1/2} \left(C + \Tr (\mathbf{D}\mathbf{A}^{-1})\right)
\end{align}
Let's now evaluate the inverses. We can write 
\begin{align}
	\mathbf{A} &=  \frac{1}{2\sigma_G^2}\left(\mathbf{I} - \frac{\sigma_I^2(\sigma_G^2 +\sigma_S^2 ||\mathbf{v}||^2)}{\kappa} \mathbf{ww}^T+ \frac{2\sigma_I^2 \sigma_S^2 (\mathbf{v}\cdot \mathbf{w})}{ \kappa} \mathbf{wv}^T - \frac{\sigma_S^2 (\sigma_G^2 + \sigma_I^2 ||\mathbf{w}||^2)}{ \kappa} \mathbf{vv}^T\right)\\
	&= \frac{1}{2\sigma_G^2}(\mathbf{I} +A_1 \mathbf{ww}^T + A_2 \mathbf{wv}^T + A_3 \mathbf{vv}^T).
\end{align}
We'll take the inverse piece by piece. First, 
\begin{align}
	(\mathbf{I} + A_1 \mathbf{ww}^T)^{-1} &= \mathbf{I} - \frac{A_1 \mathbf{ww}^T}{1 + A_1 ||\mathbf{w}||^2}.
\end{align}
Second,
\begin{align*}
	&(\mathbf{I} + A_1 \mathbf{ww}^T + A_2 \mathbf{wv}^T)^{-1} = \mathbf{I} - \frac{A_1 \mathbf{ww}^T}{1 + A_1 ||\mathbf{w}||^2} - A_2\frac{\left(\mathbf{I} - \frac{A_1 \mathbf{ww}^T}{1 + A_1 ||\mathbf{w}||^2}\right)\mathbf{wv}^T \left(\mathbf{I} - \frac{A_1 \mathbf{ww}^T}{1 + A_1 ||\mathbf{w}||^2}\right)}{1 + A_2\mathbf{v}^T \left(\mathbf{I} - \frac{A_1 \mathbf{ww}^T}{1 + A_1 ||\mathbf{w}||^2}\right)\mathbf{w}} \\
	&= \mathbf{I} -  \frac{A_1 \mathbf{ww}^T}{1 + A_1 ||\mathbf{w}||^2} \notag \\
	&-A_2\frac{\mathbf{wv}^T - \frac{A_1(\mathbf{v}\cdot \mathbf{w})}{1+ A_1||\mathbf{w}||^2} \mathbf{ww}^T - \frac{A_1||\mathbf{w}||^2}{1+ A_1||\mathbf{w}||^2} \mathbf{wv}^T  + \left(\frac{A_1}{1+ A_1||\mathbf{w}||^2}\right)^2 (\mathbf{v}\cdot \mathbf{w}) ||\mathbf{w}||^2 \mathbf{ww}^T}{1 + A_2 (\mathbf{v}\cdot \mathbf{w}) - \frac{A_1 A_2 (\mathbf{v}\cdot\mathbf{w}) ||\mathbf{w}||^2}{1 + A_1 ||\mathbf{w}||^2}} \\
	&=  \mathbf{I} -  \frac{A_1 \mathbf{ww}^T}{1 + A_1 ||\mathbf{w}||^2}  - A_2\frac{\frac{1}{1+ A_1||\mathbf{w}||^2} \left(\mathbf{wv}^T -\frac{A_1 (\mathbf{v}\cdot \mathbf{w})}{1 + A_1 ||\mathbf{w}||^2} \mathbf{ww}^T\right)}{1 + A_2 (\mathbf{v}\cdot \mathbf{w}) - \frac{A_1 A_2 (\mathbf{v}\cdot\mathbf{w}) ||\mathbf{w}||^2}{1 + A_1 ||\mathbf{w}||^2}}\\
	&= \mathbf{I} -  \frac{A_1 \mathbf{ww}^T}{1 + A_1 ||\mathbf{w}||^2} - A_2\frac{\mathbf{wv}^T -\frac{A_1 (\mathbf{v}\cdot \mathbf{w})}{1 + A_1 ||\mathbf{w}||^2} \mathbf{ww}^T}{1 + A_1 ||\mathbf{w}||^2 + A_2 (\mathbf{v} \cdot \mathbf{w})} \\
	&= \mathbf{I} - \frac{A_1}{1 + A_1 ||\mathbf{w}||^2 + A_2 (\mathbf{v}\cdot \mathbf{w})} \mathbf{ww}^T - \frac{A_2}{1 + A_1 ||\mathbf{w}||^2 + A_2(\mathbf{v}\cdot \mathbf{w})}\mathbf{wv}^T.\\
	&= \mathbf{I} - \frac{A_1 \mathbf{ww}^T + A_2 \mathbf{wv}^T}{1 + A_1 ||\mathbf{w}||^2 + A_2 (\mathbf{v}\cdot\mathbf{w})}.
\end{align*}
Lastly, 
\begin{align}
	&(\mathbf{I} + A_1 \mathbf{ww}^T + A_2 \mathbf{wv}^T + A_3 \mathbf{vv}^T)^{-1} = \mathbf{I} - \frac{A_1 \mathbf{ww}^T + A_2 \mathbf{wv}^T}{1 + A_1 ||\mathbf{w}||^2 + A_2 (\mathbf{v}\cdot\mathbf{w})} \notag \\
	&-A_3 \frac{\left(\mathbf{I} - \frac{A_1 \mathbf{ww}^T + A_2 \mathbf{wv}^T}{1 + A_1 ||\mathbf{w}||^2 + A_2 (\mathbf{v}\cdot\mathbf{w})}\right)\mathbf{vv}^T \left(\mathbf{I} - \frac{A_1 \mathbf{ww}^T + A_2 \mathbf{wv}^T}{1 + A_1 ||\mathbf{w}||^2 + A_2 (\mathbf{v}\cdot\mathbf{w})}\right)}{1 + A_3 \mathbf{v}^T \left(\mathbf{I} - \frac{A_1 \mathbf{ww}^T + A_2 \mathbf{wv}^T}{1 + A_1 ||\mathbf{w}||^2 + A_2 (\mathbf{v}\cdot\mathbf{w})}\right)\mathbf{v}}.
\end{align}
We'll focus on the last term in this expression. The denominator is 
\begin{align}
1 + A_3 ||\mathbf{v}||^2 - &\frac{A_1A_3(\mathbf{v} \cdot \mathbf{w})^2 + A_2A_3(\mathbf{v}\cdot\mathbf{w})||\mathbf{v}||^2}{1 + A_1 ||\mathbf{w}||^2 + A_2 (\mathbf{v}\cdot \mathbf{w})} \notag \\
&\qquad \qquad = 1 + \frac{A_3 ||\mathbf{v}||^2 + A_1 A_3 (||\mathbf{v}||^2 ||\mathbf{w}||^2 - (\mathbf{v}\cdot \mathbf{w})^2)}{1 + A_1 ||\mathbf{w}||^2 + A_2 (\mathbf{v}\cdot\mathbf{w})}
\end{align}
The numerator is 
\begin{align}
	&\mathbf{vv}^T - \frac{A_1 (\mathbf{v}\cdot\mathbf{w}) \mathbf{vw}^T + A_2 (\mathbf{v}\cdot \mathbf{w}) \mathbf{vv}^T}{1 + A_1 ||\mathbf{w}||^2 + A_2 (\mathbf{v}\cdot\mathbf{w})} - \frac{A_1(\mathbf{v}\cdot\mathbf{w}) \mathbf{wv}^T + A_2 ||\mathbf{v}||^2 \mathbf{wv}^T}{1 + A_1 ||\mathbf{w}||^2 + A_2 (\mathbf{v}\cdot\mathbf{w})} \notag \\
	&+ \frac{A_1^2 (\mathbf{v}\cdot\mathbf{w})^2\mathbf{ww}^T+ A_1 A_2 (\mathbf{v}\cdot\mathbf{w})^2 \mathbf{wv}^T + A_1 A_2(\mathbf{v}\cdot\mathbf{w}) ||\mathbf{v}||^2\mathbf{ww}^T + A_2^2(\mathbf{v}\cdot\mathbf{w})||\mathbf{v}||^2 \mathbf{wv}^T}{(1 + A_1 ||\mathbf{w}||^2 + A_2 (\mathbf{v}\cdot\mathbf{w}))^2}.
\end{align}
Combining the numerator and denominator into the entire expression for the inverse gives us
\begin{align}
	&(\mathbf{I} + A_1 \mathbf{ww}^T + A_2 \mathbf{wv}^T + A_3 \mathbf{vv}^T)^{-1} =  \notag \\
	& \mathbf{I} - \frac{A_1 \mathbf{ww}^T + A_2 \mathbf{wv}^T + A_3 \mathbf{vv}^T}{1 + A_1 ||\mathbf{w}||^2 + A_2 (\mathbf{v}\cdot\mathbf{w}) + A_3 ||\mathbf{v}||^2 +A_1 A_3 \left(||\mathbf{v}||^2||\mathbf{w}||^2 - (\mathbf{v}\cdot\mathbf{w})^2\right)} \notag \\
	&- A_1 A_3\frac{||\mathbf{w}||^2 \mathbf{vv}^T + ||\mathbf{v}||^2 \mathbf{ww}^T -(\mathbf{v}\cdot \mathbf{w}) \left(\mathbf{vw}^T +\mathbf{wv}^T\right)}{1 + A_1 ||\mathbf{w}||^2 + A_2 (\mathbf{v}\cdot\mathbf{w}) + A_3 ||\mathbf{v}||^2 +A_1 A_3 \left(||\mathbf{v}||^2||\mathbf{w}||^2 - (\mathbf{v}\cdot\mathbf{w})^2\right)}.
\end{align}
The determinant is 
\begin{align}
	\det \mathbf{A} = \frac{1}{2^N \sigma_G^{2N}} \det \left(\mathbf{I}+ A_1 \mathbf{ww}^T + A_2 \mathbf{wv}^T + A_3 \mathbf{vv}^T\right).
\end{align}
Proceeding iteratively with the matrix determinant lemma, we have
\begin{align}
	\det (\mathbf{I} + A_1 \mathbf{ww}^T) &= (1 + A_1 \mathbf{w}^T \mathbf{w}) (1) \\
	&= 1  + A_1 ||\mathbf{w}||^2.
\end{align}
Next,
\begin{align}
	\det (\mathbf{I} + A_1 \mathbf{ww}^T + A_2 \mathbf{wv}^T) &= \left(1 + A_2\mathbf{v}^T  \left( \mathbf{I} - \frac{A_1 \mathbf{ww}^T}{1 + A_1 ||\mathbf{w}||^2}\right) \mathbf{w}\right) (1 + A_1 ||\mathbf{w}||^2) \\
	&= \left((1  +A_1 ||\mathbf{w}||^2)(1 + A_2 (\mathbf{v}\cdot\mathbf{w})) - A_1 A_2 (\mathbf{v}\cdot\mathbf{w}) ||\mathbf{w}||^2\right) \\
	&= 1 + A_1 ||\mathbf{w}||^2 + A_2 (\mathbf{v}\cdot\mathbf{w}).
\end{align}
Finally,
\begin{align}
	\det &\left(\mathbf{I}+ A_1 \mathbf{ww}^T + A_2 \mathbf{wv}^T + A_3 \mathbf{vv}^T\right) \notag \\
	&=\left(1 + A_3 \mathbf{v}^T \left(\mathbf{I} - \frac{A_1 \mathbf{ww}^T + A_2 \mathbf{wv}^T}{1 + A_1 ||\mathbf{w}||^2 + A_2 (\mathbf{v}\cdot\mathbf{w})}\right)\mathbf{v}\right)\left(1 + A_1 ||\mathbf{w}||^2 + A_2 (\mathbf{v}\cdot\mathbf{w})\right) \\
	& =\left(1 + A_3 ||\mathbf{v}||^2 - \frac{A_1 A_3 (\mathbf{v}\cdot\mathbf{w})^2 + A_2 A_3 ||\mathbf{v}||^2 (\mathbf{v}\cdot\mathbf{w})}{1 + A_1 ||\mathbf{w}||^2 + A_2 (\mathbf{v}\cdot\mathbf{w})}\right)\left(1 + A_1 ||\mathbf{w}||^2 + A_2 (\mathbf{v}\cdot\mathbf{w})\right)\\
	&= 1 + A_1 ||\mathbf{w}||^2 + A_2 (\mathbf{v}\cdot\mathbf{w}) + A_3 ||\mathbf{v}||^2 + A_1 A_3 (||\mathbf{v}||^2 ||\mathbf{w}||^2 - (\mathbf{v}\cdot\mathbf{w})^2).
\end{align}
We have the tools in place to evaluate the mutual information. Let's make a small change for ease: we'll define
\begin{align}
	\mathbf{A}' &= \mathbf{I} + A_1 \mathbf{ww}^T + A_2 \mathbf{wv}^T + A_3 \mathbf{vv}^T
\end{align}
so that
\begin{align}
	I &= \log \frac{1}{\sigma_G} \sqrt{\frac{\kappa}{\sigma_G^2 + \sigma_I^2 ||\mathbf{w}||^2}} +\frac{1}{\sigma_G^{N-2} 2^{N/2} \sqrt{\kappa  \cdot 2^{-N} \sigma_G^{-2N}\det \mathbf{A}'}}\Tr(\mathbf{B} \mathbf{A}'^{-1}) (2\sigma_G^2) \notag \\
	&\qquad \qquad -\frac{\sigma_S^2}{2(2)^{N/2} \sigma_G^N \kappa^{5/2} (\sigma_G^2 + \sigma_I^2 ||\mathbf{w}||^2)}(2^{-N}\sigma_G^{-2N}\det \mathbf{A}')^{-1/2} \left(C + \Tr (\mathbf{D}\mathbf{A}'^{-1}) (2\sigma_G^2)\right) \\
	&= \log \frac{1}{\sigma_G} \sqrt{\frac{\kappa}{\sigma_G^2 + \sigma_I^2 ||\mathbf{w}||^2}} + \frac{2\sigma_G^4}{\sqrt{\kappa \det \mathbf{A}'}}\Tr (\mathbf{B} \mathbf{A}'^{-1}) \notag \\
	&\qquad -\frac{\sigma_S^2}{2\kappa^{5/2} (\sigma_G^2 + \sigma_I^2 ||\mathbf{w}||^2)} \frac{1}{\sqrt{\det \mathbf{A}'}} (C + 2\sigma_G^2 \Tr (\mathbf{D}\mathbf{A}'^{-1})) \\
	&= \log \frac{1}{\sigma_G} \sqrt{\frac{\kappa}{\sigma_G^2 + \sigma_I^2 ||\mathbf{w}||^2}} + \frac{\sigma_G^2}{\sqrt{\kappa \det \mathbf{A}'}} \Tr (\mathbf{B} \mathbf{A}^{-1})
\end{align}
We calculate 
\begin{align}
	\Tr(\mathbf{B}\mathbf{A}^{-1}) &= (B_1 \mathbf{ww}^T + A_2 \mathbf{wv}^T + A_3 \mathbf{vv}^T) \times \notag \\
		& \left(\mathbf{I} - \frac{A_1 \mathbf{ww}^T + A_2 \mathbf{wv}^T + A_3 \mathbf{vv}^T}{1 + A_1 ||\mathbf{w}||^2 + A_2 (\mathbf{v}\cdot\mathbf{w}) + A_3 ||\mathbf{v}||^2 +A_1 A_3 \left(||\mathbf{v}||^2||\mathbf{w}||^2 - (\mathbf{v}\cdot\mathbf{w})^2\right)} \right.\notag \\
	&- \left. A_1 A_3\frac{||\mathbf{w}||^2 \mathbf{vv}^T + ||\mathbf{v}||^2 \mathbf{ww}^T -(\mathbf{v}\cdot \mathbf{w}) \left(\mathbf{vw}^T +\mathbf{wv}^T\right)}{1 + A_1 ||\mathbf{w}||^2 + A_2 (\mathbf{v}\cdot\mathbf{w}) + A_3 ||\mathbf{v}||^2 +A_1 A_3 \left(||\mathbf{v}||^2||\mathbf{w}||^2 - (\mathbf{v}\cdot\mathbf{w})^2\right)}\right) \\
	&= \frac{B_1 ||\mathbf{w}||^2 + A_2 (\mathbf{v}\cdot\mathbf{w}) + A_3 ||\mathbf{v}||^2 + (A_1 + B_1) A_3 (||\mathbf{v}||^2 ||\mathbf{w}||^2 - (\mathbf{v}\cdot\mathbf{w})^2)}{1 + A_1 ||\mathbf{w}||^2 + A_2 (\mathbf{v}\cdot\mathbf{w}) + A_3 ||\mathbf{v}||^2 +A_1 A_3 \left(||\mathbf{v}||^2||\mathbf{w}||^2 - (\mathbf{v}\cdot\mathbf{w})^2\right)}.
\end{align}
Note that the trace of an outer product is the inner product, and furthermore the trace of a sum is the sum of the individual traces. 

The mutual information is
\begin{align}
	I &= \log \frac{1}{\sigma_G} \sqrt{\frac{\kappa}{\sigma_G^2 + \sigma_I^2 ||\mathbf{w}||^2}} \notag \\
	&+ \frac{\sigma_G^2}{\sqrt{\kappa}} \frac{B_1 ||\mathbf{w}||^2 + A_2 (\mathbf{v}\cdot\mathbf{w}) + A_3 ||\mathbf{v}||^2 + (A_1 + B_1) A_3 (||\mathbf{v}||^2 ||\mathbf{w}||^2 - (\mathbf{v}\cdot\mathbf{w}))}{\left(1 + A_1 ||\mathbf{w}||^2 + A_2 (\mathbf{v}\cdot\mathbf{w}) + A_3 ||\mathbf{v}||^2 +A_1 A_3 \left(||\mathbf{v}||^2||\mathbf{w}||^2 - (\mathbf{v}\cdot\mathbf{w})^2\right)\right)^{3/2}} \\
	&-\frac{\sigma_S^2 \sigma_G^2}{2 \kappa^{3/2}} \left(\frac{\sigma_G^2 ||\mathbf{v}||^2 + \sigma_I^2(||\mathbf{v}||^2 ||\mathbf{w}||^2 - (\mathbf{v}\cdot \mathbf{w})^2)}{\sqrt{1 + A_1 ||\mathbf{w}||^2 + A_2 (\mathbf{v}\cdot\mathbf{w}) + A_3 ||\mathbf{v}||^2 +A_1 A_3 \left(||\mathbf{v}||^2||\mathbf{w}||^2 - (\mathbf{v}\cdot\mathbf{w})^2\right)}}\right)
\end{align}





\end{document}