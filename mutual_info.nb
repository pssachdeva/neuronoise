(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    104866,       3286]
NotebookOptionsPosition[    100547,       3137]
NotebookOutlinePosition[    100911,       3153]
CellTagsIndexPosition[    100868,       3150]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"equation", " ", "4"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"p$xiI", " ", "=", " ", 
    RowBox[{
     RowBox[{"1", "/", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"2", "Pi"}], "]"}]}], " ", 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"xiI", "^", "2"}]}], "/", "2"}], "]"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"p$li$s$xiI", " ", "=", " ", 
    RowBox[{
     RowBox[{"1", "/", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"2", "Pi", " ", 
        RowBox[{"sigmaG", "^", "2"}]}], "]"}]}], " ", 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"li", " ", "-", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"vi", " ", "s"}], " ", "+", " ", 
             RowBox[{"sigmaI", " ", "wi", " ", "xiI"}]}], ")"}]}], ")"}], "^",
          "2"}]}], "/", 
       RowBox[{"(", 
        RowBox[{"2", " ", 
         RowBox[{"sigmaG", "^", "2"}]}], ")"}]}], "]"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.71657081544541*^9, 3.716570867736648*^9}, {
  3.716570935427659*^9, 3.716570967251683*^9}}],

Cell[BoxData[
 FractionBox[
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"-", 
    FractionBox[
     SuperscriptBox["xiI", "2"], "2"]}]], 
  SqrtBox[
   RowBox[{"2", " ", "\[Pi]"}]]]], "Output",
 CellChangeTimes->{3.71657086970155*^9, 3.716570939123817*^9, 
  3.716570969148079*^9, 3.7167270599672728`*^9, 3.717010039652562*^9}],

Cell[BoxData[
 FractionBox[
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"-", 
    FractionBox[
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"li", "-", 
        RowBox[{"s", " ", "vi"}], "-", 
        RowBox[{"sigmaI", " ", "wi", " ", "xiI"}]}], ")"}], "2"], 
     RowBox[{"2", " ", 
      SuperscriptBox["sigmaG", "2"]}]]}]], 
  RowBox[{
   SqrtBox[
    RowBox[{"2", " ", "\[Pi]"}]], " ", 
   SqrtBox[
    SuperscriptBox["sigmaG", "2"]]}]]], "Output",
 CellChangeTimes->{3.71657086970155*^9, 3.716570939123817*^9, 
  3.716570969148079*^9, 3.7167270599672728`*^9, 3.717010039664834*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"sanity", " ", "checks", " ", "on", " ", "pdfs"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Integrate", "[", 
    RowBox[{"p$xiI", ",", 
     RowBox[{"{", 
      RowBox[{"xiI", ",", 
       RowBox[{"-", "Infinity"}], ",", "Infinity"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Integrate", "[", 
    RowBox[{"p$li$s$xiI", ",", " ", 
     RowBox[{"{", 
      RowBox[{"li", ",", " ", 
       RowBox[{"-", "Infinity"}], ",", "Infinity"}], "}"}], ",", " ", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"sigmaG", ">", "0"}], "}"}]}]}], "]"}]}]}]], "Input"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{3.716571439444476*^9, 3.7167270629477*^9, 
  3.717010041080048*^9}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{3.716571439444476*^9, 3.7167270629477*^9, 
  3.7170100435828648`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"equation", " ", "8"}], ",", " ", 
    RowBox[{"exponential", " ", "terms"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"equation$8", " ", "=", " ", 
    RowBox[{"Collect", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"xiI", "^", "2"}]}], "/", "2"}], "-", 
       RowBox[{
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{"2", " ", 
           RowBox[{"sigmaG", "^", "2"}]}], ")"}]}], " ", 
        RowBox[{"Expand", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"li", " ", "-", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"vi", " ", "s"}], " ", "+", " ", 
              RowBox[{"sigmaI", " ", "wi", " ", "xiI"}]}], ")"}]}], ")"}], 
          "^", "2"}], "]"}]}]}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"xiI", ",", " ", 
        RowBox[{"xiI", "^", "2"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
   
   RowBox[{"equation8$mod", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"equation$8", "/.", 
          RowBox[{
           RowBox[{"li", "^", "2"}], "\[Rule]", "l2"}]}], "/.", 
         RowBox[{
          RowBox[{"li", " ", "vi"}], "\[Rule]", "lv11"}]}], "/.", 
        RowBox[{
         RowBox[{"li", " ", "wi"}], "->", "lw11"}]}], "/.", 
       RowBox[{
        RowBox[{"vi", " ", "wi"}], "\[Rule]", " ", "vw11"}]}], " ", "/.", 
      RowBox[{
       RowBox[{"wi", "^", "2"}], " ", "\[Rule]", " ", "w2"}]}], "/.", 
     RowBox[{
      RowBox[{"vi", "^", "2"}], "->", "v2"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.71657129053578*^9, 3.71657135939137*^9}, {
  3.7165714260261087`*^9, 3.71657146142568*^9}, {3.716581886483963*^9, 
  3.7165818866696568`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    SuperscriptBox["li", "2"], 
    RowBox[{"2", " ", 
     SuperscriptBox["sigmaG", "2"]}]]}], "+", 
  FractionBox[
   RowBox[{"li", " ", "s", " ", "vi"}], 
   SuperscriptBox["sigmaG", "2"]], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["s", "2"], " ", 
    SuperscriptBox["vi", "2"]}], 
   RowBox[{"2", " ", 
    SuperscriptBox["sigmaG", "2"]}]], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"li", " ", "sigmaI", " ", "wi"}], 
      SuperscriptBox["sigmaG", "2"]], "-", 
     FractionBox[
      RowBox[{"s", " ", "sigmaI", " ", "vi", " ", "wi"}], 
      SuperscriptBox["sigmaG", "2"]]}], ")"}], " ", "xiI"}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "2"]}], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["sigmaI", "2"], " ", 
       SuperscriptBox["wi", "2"]}], 
      RowBox[{"2", " ", 
       SuperscriptBox["sigmaG", "2"]}]]}], ")"}], " ", 
   SuperscriptBox["xiI", "2"]}]}]], "Output",
 CellChangeTimes->{{3.716571317127162*^9, 3.716571359971375*^9}, 
   3.716571461897168*^9, 3.716581887183813*^9, 3.716727065666801*^9, 
   3.7170100446516237`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["l2", 
    RowBox[{"2", " ", 
     SuperscriptBox["sigmaG", "2"]}]]}], "+", 
  FractionBox[
   RowBox[{"lv11", " ", "s"}], 
   SuperscriptBox["sigmaG", "2"]], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["s", "2"], " ", "v2"}], 
   RowBox[{"2", " ", 
    SuperscriptBox["sigmaG", "2"]}]], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"lw11", " ", "sigmaI"}], 
      SuperscriptBox["sigmaG", "2"]], "-", 
     FractionBox[
      RowBox[{"s", " ", "sigmaI", " ", "vw11"}], 
      SuperscriptBox["sigmaG", "2"]]}], ")"}], " ", "xiI"}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "2"]}], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["sigmaI", "2"], " ", "w2"}], 
      RowBox[{"2", " ", 
       SuperscriptBox["sigmaG", "2"]}]]}], ")"}], " ", 
   SuperscriptBox["xiI", "2"]}]}]], "Output",
 CellChangeTimes->{{3.716571317127162*^9, 3.716571359971375*^9}, 
   3.716571461897168*^9, 3.716581887183813*^9, 3.716727065666801*^9, 
   3.717010044664578*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"equation", " ", "9"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"equation$9", " ", "=", " ", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"1", "/", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{"2", "Pi", " ", 
          RowBox[{"sigmaG", "^", "2"}]}], "]"}], "^", "n"}]}], " ", "*", " ", 
      
      RowBox[{"1", "/", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"2", "Pi"}], "]"}]}], 
      RowBox[{"Integrate", "[", 
       RowBox[{
        RowBox[{"Exp", "[", "equation8$mod", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"xiI", ",", 
          RowBox[{"-", "Infinity"}], ",", "Infinity"}], "}"}], ",", " ", 
        RowBox[{"Assumptions", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"sigmaG", ">", "0"}], ",", " ", 
           RowBox[{"sigmaI", ">", "0"}], ",", " ", 
           RowBox[{"v2", ">", "0"}], ",", " ", 
           RowBox[{"w2", ">", "0"}]}], "}"}]}]}], "]"}]}], ",", " ", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{"sigmaG", ">", "0"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.716581620493361*^9, 3.716581684253586*^9}, {
  3.716581767165687*^9, 3.716581776576383*^9}, {3.716582209886394*^9, 
  3.71658223635781*^9}, {3.7165823037368593`*^9, 3.7165823040075493`*^9}, {
  3.71658241656485*^9, 3.716582425067586*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"l2", "+", 
       RowBox[{"s", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "lv11"}], "+", 
          RowBox[{"s", " ", "v2"}]}], ")"}]}], "-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["sigmaI", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"lw11", "-", 
            RowBox[{"s", " ", "vw11"}]}], ")"}], "2"]}], 
        RowBox[{
         SuperscriptBox["sigmaG", "2"], "+", 
         RowBox[{
          SuperscriptBox["sigmaI", "2"], " ", "w2"}]}]]}], 
      RowBox[{"2", " ", 
       SuperscriptBox["sigmaG", "2"]}]]}]], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"2", " ", "\[Pi]"}], ")"}], 
    RowBox[{
     RowBox[{"-", "n"}], "/", "2"}]], " ", 
   SuperscriptBox["sigmaG", 
    RowBox[{"1", "-", "n"}]]}], 
  SqrtBox[
   RowBox[{
    SuperscriptBox["sigmaG", "2"], "+", 
    RowBox[{
     SuperscriptBox["sigmaI", "2"], " ", "w2"}]}]]]], "Output",
 CellChangeTimes->{3.716581668656563*^9, 3.716581722333475*^9, 
  3.716581813963456*^9, 3.716582274887944*^9, 3.716582340412695*^9, 
  3.7165824774440536`*^9, 3.716727112808111*^9, 3.717010089123169*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "check", " ", "if", " ", "it", " ", "simplifies", " ", "to", " ", 
    "correct", " ", "thing", " ", "in", " ", "one", " ", "neuron", " ", 
    "network"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"p$l$s$one$neuron", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"equation$9", "/.", 
            RowBox[{"l2", "\[Rule]", 
             RowBox[{"l1", "^", "2"}]}]}], "/.", 
           RowBox[{"lv11", "\[Rule]", 
            RowBox[{"l1", " ", "v1"}]}]}], "/.", 
          RowBox[{"lw11", "\[Rule]", 
           RowBox[{"l1", " ", "w1"}]}]}], "/.", 
         RowBox[{"w2", "\[Rule]", 
          RowBox[{"w1", "^", "2"}]}]}], "/.", 
        RowBox[{"v2", "\[Rule]", 
         RowBox[{"v1", "^", "2"}]}]}], "/.", 
       RowBox[{"vw11", "\[Rule]", 
        RowBox[{"v1", " ", "w1"}]}]}], "/.", 
      RowBox[{"n", "\[Rule]", "1"}]}], ",", " ", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{"sigmaG", ">", "0"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.716581896468261*^9, 3.716581966773645*^9}, {
  3.716582376105482*^9, 3.716582388594741*^9}, {3.7167273507421007`*^9, 
  3.716727371458086*^9}}],

Cell[BoxData[
 FractionBox[
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"-", 
    FractionBox[
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"l1", "-", 
        RowBox[{"s", " ", "v1"}]}], ")"}], "2"], 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["sigmaG", "2"], "+", 
        RowBox[{
         SuperscriptBox["sigmaI", "2"], " ", 
         SuperscriptBox["w1", "2"]}]}], ")"}]}]]}]], 
  RowBox[{
   SqrtBox[
    RowBox[{"2", " ", "\[Pi]"}]], " ", 
   SqrtBox[
    RowBox[{
     SuperscriptBox["sigmaG", "2"], "+", 
     RowBox[{
      SuperscriptBox["sigmaI", "2"], " ", 
      SuperscriptBox["w1", "2"]}]}]]}]]], "Output",
 CellChangeTimes->{{3.716581941490272*^9, 3.7165819675598*^9}, {
   3.716582370107836*^9, 3.716582389184803*^9}, 3.716582481137452*^9, 
   3.716727198694785*^9, 3.7167273724433928`*^9, 3.7170101054179773`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"p$l$s", " ", "=", " ", "equation$9"}], "\[IndentingNewLine]", 
 RowBox[{"p$s", " ", "=", " ", 
  RowBox[{
   RowBox[{"1", "/", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"2", "Pi", " ", 
      RowBox[{"sigmaS", "^", "2"}]}], "]"}]}], " ", 
   RowBox[{"Exp", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"s", "^", "2"}]}], "/", 
     RowBox[{"(", 
      RowBox[{"2", " ", 
       RowBox[{"sigmaS", "^", "2"}]}], ")"}]}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.716582555649382*^9, 3.716582601759589*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"l2", "+", 
       RowBox[{"s", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "lv11"}], "+", 
          RowBox[{"s", " ", "v2"}]}], ")"}]}], "-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["sigmaI", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"lw11", "-", 
            RowBox[{"s", " ", "vw11"}]}], ")"}], "2"]}], 
        RowBox[{
         SuperscriptBox["sigmaG", "2"], "+", 
         RowBox[{
          SuperscriptBox["sigmaI", "2"], " ", "w2"}]}]]}], 
      RowBox[{"2", " ", 
       SuperscriptBox["sigmaG", "2"]}]]}]], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"2", " ", "\[Pi]"}], ")"}], 
    RowBox[{
     RowBox[{"-", "n"}], "/", "2"}]], " ", 
   SuperscriptBox["sigmaG", 
    RowBox[{"1", "-", "n"}]]}], 
  SqrtBox[
   RowBox[{
    SuperscriptBox["sigmaG", "2"], "+", 
    RowBox[{
     SuperscriptBox["sigmaI", "2"], " ", "w2"}]}]]]], "Output",
 CellChangeTimes->{{3.716582561096534*^9, 3.7165826024920588`*^9}, 
   3.716727227535377*^9, 3.717010107694631*^9}],

Cell[BoxData[
 FractionBox[
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"-", 
    FractionBox[
     SuperscriptBox["s", "2"], 
     RowBox[{"2", " ", 
      SuperscriptBox["sigmaS", "2"]}]]}]], 
  RowBox[{
   SqrtBox[
    RowBox[{"2", " ", "\[Pi]"}]], " ", 
   SqrtBox[
    SuperscriptBox["sigmaS", "2"]]}]]], "Output",
 CellChangeTimes->{{3.716582561096534*^9, 3.7165826024920588`*^9}, 
   3.716727227535377*^9, 3.717010107706833*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"equation", " ", "11"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"p$l", " ", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"Integrate", "[", 
     RowBox[{
      RowBox[{"p$l$s", " ", "p$s"}], ",", 
      RowBox[{"{", 
       RowBox[{"s", ",", 
        RowBox[{"-", "Infinity"}], ",", "Infinity"}], "}"}], ",", " ", 
      RowBox[{"Assumptions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"sigmaG", ">", "0"}], ",", " ", 
         RowBox[{"sigmaI", ">", "0"}], ",", " ", 
         RowBox[{"sigmaS", ">", "0"}], ",", " ", 
         RowBox[{"v2", ">", "0"}], ",", " ", 
         RowBox[{"w2", ">", "0"}], ",", " ", 
         RowBox[{
          RowBox[{"v2", " ", "w2"}], ">", " ", 
          RowBox[{"vw11", "^", "2"}]}]}], "}"}]}]}], "]"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.716582604020399*^9, 3.716582620234441*^9}, {
  3.7165826945155478`*^9, 3.716582715851178*^9}, {3.716582907377934*^9, 
  3.716582912489642*^9}, {3.716583292684389*^9, 3.7165833052755003`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     FractionBox[
      RowBox[{
       RowBox[{
        SuperscriptBox["lw11", "2"], " ", 
        SuperscriptBox["sigmaI", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["sigmaG", "2"], "+", 
          RowBox[{
           SuperscriptBox["sigmaS", "2"], " ", "v2"}]}], ")"}]}], "-", 
       RowBox[{"2", " ", "lv11", " ", "lw11", " ", 
        SuperscriptBox["sigmaI", "2"], " ", 
        SuperscriptBox["sigmaS", "2"], " ", "vw11"}], "+", 
       RowBox[{
        SuperscriptBox["lv11", "2"], " ", 
        SuperscriptBox["sigmaS", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["sigmaG", "2"], "+", 
          RowBox[{
           SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}]}], "-", 
       RowBox[{"l2", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["sigmaG", "4"], "+", 
          RowBox[{
           SuperscriptBox["sigmaG", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["sigmaS", "2"], " ", "v2"}], "+", 
             RowBox[{
              SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["sigmaI", "2"], " ", 
           SuperscriptBox["sigmaS", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox["vw11", "2"]}], "+", 
             RowBox[{"v2", " ", "w2"}]}], ")"}]}]}], ")"}]}]}], 
      RowBox[{"2", " ", 
       SuperscriptBox["sigmaG", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["sigmaG", "4"], "+", 
         RowBox[{
          SuperscriptBox["sigmaG", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["sigmaS", "2"], " ", "v2"}], "+", 
            RowBox[{
             SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["sigmaI", "2"], " ", 
          SuperscriptBox["sigmaS", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["vw11", "2"]}], "+", 
            RowBox[{"v2", " ", "w2"}]}], ")"}]}]}], ")"}]}]]], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"2", " ", "\[Pi]"}], ")"}], 
     RowBox[{
      RowBox[{"-", "n"}], "/", "2"}]], " ", 
    SuperscriptBox["sigmaG", 
     RowBox[{"2", "-", "n"}]]}], ")"}], "/", 
  RowBox[{"(", 
   SqrtBox[
    RowBox[{
     SuperscriptBox["sigmaG", "4"], "+", 
     RowBox[{
      SuperscriptBox["sigmaG", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["sigmaS", "2"], " ", "v2"}], "+", 
        RowBox[{
         SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["sigmaI", "2"], " ", 
      SuperscriptBox["sigmaS", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["vw11", "2"]}], "+", 
        RowBox[{"v2", " ", "w2"}]}], ")"}]}]}]], ")"}]}]], "Output",
 CellChangeTimes->{3.716582662363608*^9, 3.7165827672177362`*^9, 
  3.71658299531182*^9, 3.716583383220186*^9, 3.716727316272089*^9, 
  3.717010193130377*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"equation", " ", "15"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"kappa", " ", "=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Expand", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"sigmaG", "^", "2"}], " ", "+", " ", 
         RowBox[{
          RowBox[{"sigmaI", "^", "2"}], " ", "w2"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"sigmaG", "^", "2"}], " ", "+", " ", 
         RowBox[{
          RowBox[{"sigmaS", "^", "2"}], " ", "v2"}]}], ")"}]}], " ", "-", " ", 
      RowBox[{
       RowBox[{"sigmaI", "^", "2"}], " ", 
       RowBox[{"sigmaS", "^", "2"}], " ", 
       RowBox[{"vw11", "^", "2"}]}]}], "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7165828100914516`*^9, 3.7165828490867653`*^9}, {
  3.716583998207684*^9, 3.716583998311323*^9}}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["sigmaG", "4"], "+", 
  RowBox[{
   SuperscriptBox["sigmaG", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["sigmaS", "2"], " ", "v2"}], "+", 
     RowBox[{
      SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}]}], "+", 
  RowBox[{
   SuperscriptBox["sigmaI", "2"], " ", 
   SuperscriptBox["sigmaS", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["vw11", "2"]}], "+", 
     RowBox[{"v2", " ", "w2"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.716582836300861*^9, 3.716582850135159*^9}, 
   3.716727381915495*^9, 3.717010203802099*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"equation", " ", "14"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"p$l", " ", "=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"p$l", "/.", 
      RowBox[{"kappa", "\[Rule]", "k"}]}], ",", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"sigmaG", ">", "0"}], ",", " ", 
        RowBox[{"sigmaI", ">", "0"}], ",", " ", 
        RowBox[{"sigmaS", ">", "0"}], ",", " ", 
        RowBox[{"k", ">", "0"}]}], "}"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.716583395564707*^9, 3.716583433303286*^9}, {
  3.716583804355167*^9, 3.716583804937881*^9}, {3.716583972520184*^9, 
  3.7165839726549053`*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"-", "k"}], " ", "l2"}], "+", 
      RowBox[{
       SuperscriptBox["lw11", "2"], " ", 
       SuperscriptBox["sigmaI", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["sigmaG", "2"], "+", 
         RowBox[{
          SuperscriptBox["sigmaS", "2"], " ", "v2"}]}], ")"}]}], "-", 
      RowBox[{"2", " ", "lv11", " ", "lw11", " ", 
       SuperscriptBox["sigmaI", "2"], " ", 
       SuperscriptBox["sigmaS", "2"], " ", "vw11"}], "+", 
      RowBox[{
       SuperscriptBox["lv11", "2"], " ", 
       SuperscriptBox["sigmaS", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["sigmaG", "2"], "+", 
         RowBox[{
          SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}]}]}], 
     RowBox[{"2", " ", "k", " ", 
      SuperscriptBox["sigmaG", "2"]}]]], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"2", " ", "\[Pi]"}], ")"}], 
    RowBox[{
     RowBox[{"-", "n"}], "/", "2"}]], " ", 
   SuperscriptBox["sigmaG", 
    RowBox[{"2", "-", "n"}]]}], 
  SqrtBox["k"]]], "Output",
 CellChangeTimes->{{3.7165834160146713`*^9, 3.71658343381735*^9}, 
   3.716727385767252*^9, 3.717010206608809*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"sanity", " ", "check"}], ",", " ", 
    RowBox[{
     RowBox[{"p", "[", "l", "]"}], " ", "reduces", " ", "to", " ", "correct", 
     " ", "form", " ", "in", " ", "one", " ", "neuron", " ", "network"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"p$l$one$neuron", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"p$l", "/.", 
             RowBox[{"k", "\[Rule]", "kappa"}]}], "/.", 
            RowBox[{"l2", "\[Rule]", 
             RowBox[{"l1", "^", "2"}]}]}], "/.", 
           RowBox[{"lv11", "\[Rule]", 
            RowBox[{"l1", " ", "v1"}]}]}], "/.", 
          RowBox[{"lw11", "\[Rule]", 
           RowBox[{"l1", " ", "w1"}]}]}], "/.", 
         RowBox[{"w2", "\[Rule]", 
          RowBox[{"w1", "^", "2"}]}]}], "/.", 
        RowBox[{"v2", "\[Rule]", 
         RowBox[{"v1", "^", "2"}]}]}], "/.", 
       RowBox[{"vw11", "\[Rule]", 
        RowBox[{"v1", " ", "w1"}]}]}], "/.", 
      RowBox[{"n", "\[Rule]", "1"}]}], ",", " ", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{"sigmaG", ">", "0"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.716583542499113*^9, 3.716583588859844*^9}, {
  3.716583731410812*^9, 3.716583778529801*^9}, {3.7167273888511677`*^9, 
  3.716727394114849*^9}}],

Cell[BoxData[
 FractionBox[
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"-", 
    FractionBox[
     SuperscriptBox["l1", "2"], 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["sigmaG", "2"], "+", 
        RowBox[{
         SuperscriptBox["sigmaS", "2"], " ", 
         SuperscriptBox["v1", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["sigmaI", "2"], " ", 
         SuperscriptBox["w1", "2"]}]}], ")"}]}]]}]], 
  RowBox[{
   SqrtBox[
    RowBox[{"2", " ", "\[Pi]"}]], " ", 
   SqrtBox[
    RowBox[{
     SuperscriptBox["sigmaG", "2"], "+", 
     RowBox[{
      SuperscriptBox["sigmaS", "2"], " ", 
      SuperscriptBox["v1", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["sigmaI", "2"], " ", 
      SuperscriptBox["w1", "2"]}]}]]}]]], "Output",
 CellChangeTimes->{
  3.716583558237729*^9, 3.716583592724802*^9, {3.716583735193836*^9, 
   3.716583749690338*^9}, 3.71658378123394*^9, 3.7167273949087553`*^9, 
   3.7170102101773453`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"equation$17", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"p$l$s", "/", "p$l"}], ",", " ", 
    RowBox[{"Assumptions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"sigmaG", ">", "0"}], ",", " ", 
       RowBox[{"sigmaI", ">", "0"}], ",", " ", 
       RowBox[{"sigmaS", ">", "0"}], ",", " ", 
       RowBox[{"k", ">", "0"}]}], "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.716584050300992*^9, 3.716584058361253*^9}, {
  3.716584382508088*^9, 3.716584383050602*^9}, {3.716584790015802*^9, 
  3.716584803369953*^9}, {3.716585352199894*^9, 3.71658535732646*^9}}],

Cell[BoxData[
 FractionBox[
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{"s", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "lv11"}], "+", 
         RowBox[{"s", " ", "v2"}]}], ")"}]}], "+", 
      FractionBox[
       RowBox[{
        SuperscriptBox["lw11", "2"], " ", 
        SuperscriptBox["sigmaI", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["sigmaG", "2"], "+", 
          RowBox[{
           SuperscriptBox["sigmaS", "2"], " ", "v2"}]}], ")"}]}], "k"], "-", 
      FractionBox[
       RowBox[{"2", " ", "lv11", " ", "lw11", " ", 
        SuperscriptBox["sigmaI", "2"], " ", 
        SuperscriptBox["sigmaS", "2"], " ", "vw11"}], "k"], "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["sigmaI", "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"lw11", "-", 
           RowBox[{"s", " ", "vw11"}]}], ")"}], "2"]}], 
       RowBox[{
        SuperscriptBox["sigmaG", "2"], "+", 
        RowBox[{
         SuperscriptBox["sigmaI", "2"], " ", "w2"}]}]], "+", 
      FractionBox[
       RowBox[{
        SuperscriptBox["lv11", "2"], " ", 
        SuperscriptBox["sigmaS", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["sigmaG", "2"], "+", 
          RowBox[{
           SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}]}], "k"]}], 
     RowBox[{"2", " ", 
      SuperscriptBox["sigmaG", "2"]}]]}]], 
  RowBox[{"sigmaG", " ", 
   SqrtBox[
    FractionBox[
     RowBox[{
      SuperscriptBox["sigmaG", "2"], "+", 
      RowBox[{
       SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], "k"]]}]]], "Output",
 CellChangeTimes->{
  3.7165840591541967`*^9, {3.716584783909349*^9, 3.716584804780615*^9}, 
   3.716585358004636*^9, 3.716727399874833*^9, 3.717010212839408*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"sanity", " ", "check"}], ",", " ", 
    RowBox[{
    "equation", " ", "17", " ", "reduces", " ", "to", " ", "correct", " ", 
     "form", " ", "in", " ", "one", " ", "neuron", " ", "network"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "denominators", " ", "are", " ", "equal", " ", "if", " ", "combined", " ", 
    "into", " ", "one", " ", "fraction"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"equation$17", "/.", 
             RowBox[{"k", "\[Rule]", "kappa"}]}], "/.", 
            RowBox[{"l2", "\[Rule]", 
             RowBox[{"l1", "^", "2"}]}]}], "/.", 
           RowBox[{"lv11", "\[Rule]", 
            RowBox[{"l1", " ", "v1"}]}]}], "/.", 
          RowBox[{"lw11", "\[Rule]", 
           RowBox[{"l1", " ", "w1"}]}]}], "/.", 
         RowBox[{"w2", "\[Rule]", 
          RowBox[{"w1", "^", "2"}]}]}], "/.", 
        RowBox[{"v2", "\[Rule]", 
         RowBox[{"v1", "^", "2"}]}]}], "/.", 
       RowBox[{"vw11", "\[Rule]", 
        RowBox[{"v1", " ", "w1"}]}]}], "/.", 
      RowBox[{"n", "\[Rule]", "1"}]}], ",", " ", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{"sigmaG", ">", "0"}]}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"p$l$s$one$neuron", "/", "p$l$one$neuron"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.71672740273495*^9, 3.716727476125536*^9}, {
  3.716727555263969*^9, 3.716727569279814*^9}}],

Cell[BoxData[
 FractionBox[
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"l1", "-", 
           RowBox[{"s", " ", "v1"}]}], ")"}], "2"], 
        RowBox[{
         SuperscriptBox["sigmaG", "2"], "+", 
         RowBox[{
          SuperscriptBox["sigmaI", "2"], " ", 
          SuperscriptBox["w1", "2"]}]}]]}], "+", 
      FractionBox[
       SuperscriptBox["l1", "2"], 
       RowBox[{
        SuperscriptBox["sigmaG", "2"], "+", 
        RowBox[{
         SuperscriptBox["sigmaS", "2"], " ", 
         SuperscriptBox["v1", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["sigmaI", "2"], " ", 
         SuperscriptBox["w1", "2"]}]}]]}], ")"}]}]], 
  SqrtBox[
   RowBox[{"1", "-", 
    FractionBox[
     RowBox[{
      SuperscriptBox["sigmaS", "2"], " ", 
      SuperscriptBox["v1", "2"]}], 
     RowBox[{
      SuperscriptBox["sigmaG", "2"], "+", 
      RowBox[{
       SuperscriptBox["sigmaS", "2"], " ", 
       SuperscriptBox["v1", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["sigmaI", "2"], " ", 
       SuperscriptBox["w1", "2"]}]}]]}]]]], "Output",
 CellChangeTimes->{{3.7167274572871313`*^9, 3.716727477230565*^9}, 
   3.7170102331484833`*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"l1", "-", 
            RowBox[{"s", " ", "v1"}]}], ")"}], "2"], 
         RowBox[{
          SuperscriptBox["sigmaG", "2"], "+", 
          RowBox[{
           SuperscriptBox["sigmaI", "2"], " ", 
           SuperscriptBox["w1", "2"]}]}]]}], "+", 
       FractionBox[
        SuperscriptBox["l1", "2"], 
        RowBox[{
         SuperscriptBox["sigmaG", "2"], "+", 
         RowBox[{
          SuperscriptBox["sigmaS", "2"], " ", 
          SuperscriptBox["v1", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["sigmaI", "2"], " ", 
          SuperscriptBox["w1", "2"]}]}]]}], ")"}]}]], " ", 
   SqrtBox[
    RowBox[{
     SuperscriptBox["sigmaG", "2"], "+", 
     RowBox[{
      SuperscriptBox["sigmaS", "2"], " ", 
      SuperscriptBox["v1", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["sigmaI", "2"], " ", 
      SuperscriptBox["w1", "2"]}]}]]}], 
  SqrtBox[
   RowBox[{
    SuperscriptBox["sigmaG", "2"], "+", 
    RowBox[{
     SuperscriptBox["sigmaI", "2"], " ", 
     SuperscriptBox["w1", "2"]}]}]]]], "Output",
 CellChangeTimes->{{3.7167274572871313`*^9, 3.716727477230565*^9}, 
   3.7170102405957127`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"p$l$ratio", " ", "=", " ", "equation$17"}]], "Input",
 CellChangeTimes->{{3.7167275997186213`*^9, 3.716727605488166*^9}}],

Cell[BoxData[
 FractionBox[
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{"s", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "lv11"}], "+", 
         RowBox[{"s", " ", "v2"}]}], ")"}]}], "+", 
      FractionBox[
       RowBox[{
        SuperscriptBox["lw11", "2"], " ", 
        SuperscriptBox["sigmaI", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["sigmaG", "2"], "+", 
          RowBox[{
           SuperscriptBox["sigmaS", "2"], " ", "v2"}]}], ")"}]}], "k"], "-", 
      FractionBox[
       RowBox[{"2", " ", "lv11", " ", "lw11", " ", 
        SuperscriptBox["sigmaI", "2"], " ", 
        SuperscriptBox["sigmaS", "2"], " ", "vw11"}], "k"], "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["sigmaI", "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"lw11", "-", 
           RowBox[{"s", " ", "vw11"}]}], ")"}], "2"]}], 
       RowBox[{
        SuperscriptBox["sigmaG", "2"], "+", 
        RowBox[{
         SuperscriptBox["sigmaI", "2"], " ", "w2"}]}]], "+", 
      FractionBox[
       RowBox[{
        SuperscriptBox["lv11", "2"], " ", 
        SuperscriptBox["sigmaS", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["sigmaG", "2"], "+", 
          RowBox[{
           SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}]}], "k"]}], 
     RowBox[{"2", " ", 
      SuperscriptBox["sigmaG", "2"]}]]}]], 
  RowBox[{"sigmaG", " ", 
   SqrtBox[
    FractionBox[
     RowBox[{
      SuperscriptBox["sigmaG", "2"], "+", 
      RowBox[{
       SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], "k"]]}]]], "Output",
 CellChangeTimes->{3.716727611660568*^9, 3.71701024496465*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"equations", " ", "19"}], " ", "-", " ", "22"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"logexpand", " ", "=", " ", 
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{"PowerExpand", "[", 
      RowBox[{"Log", "[", "p$l$ratio", "]"}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"s", ",", " ", 
       RowBox[{"s", "^", "2"}], ",", " ", 
       RowBox[{"lw11", "^", "2"}], ",", " ", 
       RowBox[{"lw11", " ", "lv11"}], ",", " ", 
       RowBox[{"lv11", "^", "2"}]}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.716727616948873*^9, 3.716727628448372*^9}, {
  3.716727695627809*^9, 3.716727737835741*^9}, {3.7167277903874207`*^9, 
  3.716727834398204*^9}, {3.71672806401334*^9, 3.716728130261889*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"lv11", " ", "lw11", " ", 
    SuperscriptBox["sigmaI", "2"], " ", 
    SuperscriptBox["sigmaS", "2"], " ", "vw11"}], 
   RowBox[{"k", " ", 
    SuperscriptBox["sigmaG", "2"]}]], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["lv11", "2"], " ", 
    SuperscriptBox["sigmaS", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["sigmaG", "2"], "+", 
      RowBox[{
       SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}]}], 
   RowBox[{"2", " ", "k", " ", 
    SuperscriptBox["sigmaG", "2"]}]], "+", 
  RowBox[{
   SuperscriptBox["lw11", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["sigmaI", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["sigmaG", "2"], "+", 
          RowBox[{
           SuperscriptBox["sigmaS", "2"], " ", "v2"}]}], ")"}]}], 
       RowBox[{"2", " ", "k", " ", 
        SuperscriptBox["sigmaG", "2"]}]]}], "+", 
     FractionBox[
      SuperscriptBox["sigmaI", "2"], 
      RowBox[{"2", " ", 
       SuperscriptBox["sigmaG", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["sigmaG", "2"], "+", 
         RowBox[{
          SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}]}]]}], ")"}]}], 
  "+", 
  RowBox[{"s", " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox["lv11", 
      SuperscriptBox["sigmaG", "2"]], "-", 
     FractionBox[
      RowBox[{"lw11", " ", 
       SuperscriptBox["sigmaI", "2"], " ", "vw11"}], 
      RowBox[{
       SuperscriptBox["sigmaG", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["sigmaG", "2"], "+", 
         RowBox[{
          SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}]}]]}], ")"}]}], 
  "+", 
  RowBox[{
   SuperscriptBox["s", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["v2", 
       RowBox[{"2", " ", 
        SuperscriptBox["sigmaG", "2"]}]]}], "+", 
     FractionBox[
      RowBox[{
       SuperscriptBox["sigmaI", "2"], " ", 
       SuperscriptBox["vw11", "2"]}], 
      RowBox[{"2", " ", 
       SuperscriptBox["sigmaG", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["sigmaG", "2"], "+", 
         RowBox[{
          SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}]}]]}], ")"}]}], 
  "-", 
  RowBox[{"Log", "[", "sigmaG", "]"}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Log", "[", "k", "]"}], "-", 
     RowBox[{"Log", "[", 
      RowBox[{
       SuperscriptBox["sigmaG", "2"], "+", 
       RowBox[{
        SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], "]"}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{{3.716727621481679*^9, 3.716727628921403*^9}, 
   3.716727697389265*^9, 3.7167277381356077`*^9, 3.716727835053801*^9, {
   3.716728122127016*^9, 3.716728130648378*^9}, 3.717010247403656*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "make", " ", "sure", " ", "the", " ", "terms", " ", "are", " ", "right"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"equation$20$lw11$2", " ", "=", " ", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{"FullSimplify", "[", 
       RowBox[{
        RowBox[{"Coefficient", "[", 
         RowBox[{"logexpand", ",", " ", 
          RowBox[{"lw11", "^", "2"}]}], "]"}], "/.", 
        RowBox[{"k", "\[Rule]", "kappa"}]}], "]"}], "/.", 
      RowBox[{"kappa", "\[Rule]", "k"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"equation$20$lw11$lv11", " ", "=", " ", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"Coefficient", "[", 
      RowBox[{"logexpand", ",", 
       RowBox[{"lv11", " ", "lw11"}]}], "]"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"equation$20$lv11$2", " ", "=", " ", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{"FullSimplify", "[", 
       RowBox[{
        RowBox[{"Coefficient", "[", 
         RowBox[{"logexpand", ",", " ", 
          RowBox[{"lv11", "^", "2"}]}], "]"}], "/.", 
        RowBox[{"k", "\[Rule]", "kappa"}]}], "]"}], "/.", 
      RowBox[{"kappa", "\[Rule]", "k"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.716728034258169*^9, 3.716728051795615*^9}, {
  3.716728133712104*^9, 3.716728175919581*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["sigmaI", "4"], " ", 
    SuperscriptBox["sigmaS", "2"], " ", 
    SuperscriptBox["vw11", "2"]}], 
   RowBox[{
    RowBox[{"2", " ", "k", " ", 
     SuperscriptBox["sigmaG", "4"]}], "+", 
    RowBox[{"2", " ", "k", " ", 
     SuperscriptBox["sigmaG", "2"], " ", 
     SuperscriptBox["sigmaI", "2"], " ", "w2"}]}]]}]], "Output",
 CellChangeTimes->{3.716728052504217*^9, 3.716728176496139*^9, 
  3.7170102501093607`*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["sigmaI", "2"], " ", 
   SuperscriptBox["sigmaS", "2"], " ", "vw11"}], 
  RowBox[{"k", " ", 
   SuperscriptBox["sigmaG", "2"]}]]], "Output",
 CellChangeTimes->{3.716728052504217*^9, 3.716728176496139*^9, 
  3.7170102501218777`*^9}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["sigmaS", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["sigmaG", "2"], "+", 
      RowBox[{
       SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}]}], 
   RowBox[{"2", " ", "k", " ", 
    SuperscriptBox["sigmaG", "2"]}]]}]], "Output",
 CellChangeTimes->{3.716728052504217*^9, 3.716728176496139*^9, 
  3.717010250235321*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "make", " ", "sure", " ", "terms", " ", "in", " ", "equation", " ", "22", 
    " ", "are", " ", "right"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"equation$22", " ", "=", " ", 
   RowBox[{
    RowBox[{"s", " ", 
     RowBox[{"Coefficient", "[", 
      RowBox[{"logexpand", ",", " ", "s"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"s", "^", "2"}], " ", 
     RowBox[{"Coefficient", "[", 
      RowBox[{"logexpand", ",", " ", 
       RowBox[{"s", "^", "2"}]}], "]"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.7167282551469793`*^9, 3.716728319850692*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"s", " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox["lv11", 
      SuperscriptBox["sigmaG", "2"]], "-", 
     FractionBox[
      RowBox[{"lw11", " ", 
       SuperscriptBox["sigmaI", "2"], " ", "vw11"}], 
      RowBox[{
       SuperscriptBox["sigmaG", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["sigmaG", "2"], "+", 
         RowBox[{
          SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}]}]]}], ")"}]}], 
  "+", 
  RowBox[{
   SuperscriptBox["s", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["v2", 
       RowBox[{"2", " ", 
        SuperscriptBox["sigmaG", "2"]}]]}], "+", 
     FractionBox[
      RowBox[{
       SuperscriptBox["sigmaI", "2"], " ", 
       SuperscriptBox["vw11", "2"]}], 
      RowBox[{"2", " ", 
       SuperscriptBox["sigmaG", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["sigmaG", "2"], "+", 
         RowBox[{
          SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}]}]]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{{3.716728307690888*^9, 3.716728320223736*^9}, 
   3.717010252516099*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"kappa$matrix", " ", "=", " ", 
  RowBox[{
   RowBox[{"kappa", "/.", 
    RowBox[{"w2", "\[Rule]", 
     RowBox[{
      RowBox[{"Norm", "[", "w", "]"}], "^", "2"}]}]}], "/.", 
   RowBox[{"v2", "\[Rule]", 
    RowBox[{
     RowBox[{"Norm", "[", "v", "]"}], "^", "2"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"p$l$matrix", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"p$l", "/.", 
          RowBox[{"k", "\[Rule]", "kappa$matrix"}]}], "/.", 
         RowBox[{
          RowBox[{"lw11", "^", "2"}], "\[Rule]", 
          RowBox[{
           RowBox[{"Transpose", "[", "l", "]"}], ".", "w", ".", 
           RowBox[{"Transpose", "[", "w", "]"}], ".", "l"}]}]}], "/.", 
        RowBox[{
         RowBox[{"lv11", "^", "2"}], "\[Rule]", 
         RowBox[{
          RowBox[{"Transpose", "[", "l", "]"}], ".", "v", ".", 
          RowBox[{"Transpose", "[", "v", "]"}], ".", "l"}]}]}], "/.", 
       RowBox[{
        RowBox[{"lv11", " ", "lw11"}], "\[Rule]", 
        RowBox[{
         RowBox[{"Transpose", "[", "l", "]"}], ".", "w", ".", 
         RowBox[{"Transpose", "[", "v", "]"}], ".", "l"}]}]}], "/.", 
      RowBox[{"vw11", "\[Rule]", 
       RowBox[{"v", ".", "w"}]}]}], "/.", 
     RowBox[{"w2", "\[Rule]", 
      RowBox[{
       RowBox[{"Norm", "[", "w", "]"}], "^", "2"}]}]}], "/.", 
    RowBox[{"v2", "\[Rule]", 
     RowBox[{
      RowBox[{"Norm", "[", "v", "]"}], "^", "2"}]}]}], "/.", 
   RowBox[{"l2", "\[Rule]", 
    RowBox[{
     RowBox[{"Transpose", "[", "l", "]"}], ".", "l"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.7167284480176487`*^9, 3.716728448509836*^9}, {
   3.716728755874195*^9, 3.716728782710977*^9}, {3.716728828553535*^9, 
   3.716728829002009*^9}, {3.716728864786489*^9, 3.7167288774776278`*^9}, {
   3.716729140898074*^9, 3.716729313318932*^9}, {3.716729350855906*^9, 
   3.716729424232633*^9}, 3.716729571976418*^9}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["sigmaG", "4"], "+", 
  RowBox[{
   SuperscriptBox["sigmaG", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["sigmaS", "2"], " ", 
      SuperscriptBox[
       RowBox[{"Norm", "[", "v", "]"}], "2"]}], "+", 
     RowBox[{
      SuperscriptBox["sigmaI", "2"], " ", 
      SuperscriptBox[
       RowBox[{"Norm", "[", "w", "]"}], "2"]}]}], ")"}]}], "+", 
  RowBox[{
   SuperscriptBox["sigmaI", "2"], " ", 
   SuperscriptBox["sigmaS", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["vw11", "2"]}], "+", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"Norm", "[", "v", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"Norm", "[", "w", "]"}], "2"]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.716729141935239*^9, 3.716729191070154*^9, 3.716729252718395*^9, {
   3.7167293077215557`*^9, 3.716729313796253*^9}, 3.716729356255685*^9, 
   3.716729425028781*^9, 3.7167295742862167`*^9, 3.7170102547976294`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     FractionBox[
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", 
        SuperscriptBox["sigmaI", "2"], " ", 
        SuperscriptBox["sigmaS", "2"], " ", 
        RowBox[{"v", ".", "w"}], " ", 
        RowBox[{
         RowBox[{"Transpose", "[", "l", "]"}], ".", "w", ".", 
         RowBox[{"Transpose", "[", "v", "]"}], ".", "l"}]}], "+", 
       RowBox[{
        SuperscriptBox["sigmaI", "2"], " ", 
        RowBox[{
         RowBox[{"Transpose", "[", "l", "]"}], ".", "w", ".", 
         RowBox[{"Transpose", "[", "w", "]"}], ".", "l"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["sigmaG", "2"], "+", 
          RowBox[{
           SuperscriptBox["sigmaS", "2"], " ", 
           SuperscriptBox[
            RowBox[{"Norm", "[", "v", "]"}], "2"]}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["sigmaS", "2"], " ", 
        RowBox[{
         RowBox[{"Transpose", "[", "l", "]"}], ".", "v", ".", 
         RowBox[{"Transpose", "[", "v", "]"}], ".", "l"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["sigmaG", "2"], "+", 
          RowBox[{
           SuperscriptBox["sigmaI", "2"], " ", 
           SuperscriptBox[
            RowBox[{"Norm", "[", "w", "]"}], "2"]}]}], ")"}]}], "-", 
       RowBox[{
        RowBox[{
         RowBox[{"Transpose", "[", "l", "]"}], ".", "l"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["sigmaG", "4"], "+", 
          RowBox[{
           SuperscriptBox["sigmaG", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["sigmaS", "2"], " ", 
              SuperscriptBox[
               RowBox[{"Norm", "[", "v", "]"}], "2"]}], "+", 
             RowBox[{
              SuperscriptBox["sigmaI", "2"], " ", 
              SuperscriptBox[
               RowBox[{"Norm", "[", "w", "]"}], "2"]}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["sigmaI", "2"], " ", 
           SuperscriptBox["sigmaS", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"v", ".", "w"}], ")"}], "2"]}], "+", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"Norm", "[", "v", "]"}], "2"], " ", 
              SuperscriptBox[
               RowBox[{"Norm", "[", "w", "]"}], "2"]}]}], ")"}]}]}], 
         ")"}]}]}], 
      RowBox[{"2", " ", 
       SuperscriptBox["sigmaG", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["sigmaG", "4"], "+", 
         RowBox[{
          SuperscriptBox["sigmaG", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["sigmaS", "2"], " ", 
             SuperscriptBox[
              RowBox[{"Norm", "[", "v", "]"}], "2"]}], "+", 
            RowBox[{
             SuperscriptBox["sigmaI", "2"], " ", 
             SuperscriptBox[
              RowBox[{"Norm", "[", "w", "]"}], "2"]}]}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["sigmaI", "2"], " ", 
          SuperscriptBox["sigmaS", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"v", ".", "w"}], ")"}], "2"]}], "+", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"Norm", "[", "v", "]"}], "2"], " ", 
             SuperscriptBox[
              RowBox[{"Norm", "[", "w", "]"}], "2"]}]}], ")"}]}]}], ")"}]}]]],
     " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"2", " ", "\[Pi]"}], ")"}], 
     RowBox[{
      RowBox[{"-", "n"}], "/", "2"}]], " ", 
    SuperscriptBox["sigmaG", 
     RowBox[{"2", "-", "n"}]]}], ")"}], "/", 
  RowBox[{"(", 
   SqrtBox[
    RowBox[{
     SuperscriptBox["sigmaG", "4"], "+", 
     RowBox[{
      SuperscriptBox["sigmaG", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["sigmaS", "2"], " ", 
         SuperscriptBox[
          RowBox[{"Norm", "[", "v", "]"}], "2"]}], "+", 
        RowBox[{
         SuperscriptBox["sigmaI", "2"], " ", 
         SuperscriptBox[
          RowBox[{"Norm", "[", "w", "]"}], "2"]}]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["sigmaI", "2"], " ", 
      SuperscriptBox["sigmaS", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"v", ".", "w"}], ")"}], "2"]}], "+", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"Norm", "[", "v", "]"}], "2"], " ", 
         SuperscriptBox[
          RowBox[{"Norm", "[", "w", "]"}], "2"]}]}], ")"}]}]}]], 
   ")"}]}]], "Output",
 CellChangeTimes->{
  3.716729141935239*^9, 3.716729191070154*^9, 3.716729252718395*^9, {
   3.7167293077215557`*^9, 3.716729313796253*^9}, 3.716729356255685*^9, 
   3.716729425028781*^9, 3.7167295742862167`*^9, 3.71701025481299*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "matrix", " ", "form", " ", "reduces", " ", "to", " ", "correct", " ", 
    "answer"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"p$l$one$neuron$matrix", " ", "=", " ", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"p$l$matrix", "/.", 
         RowBox[{"v", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"{", "v1", "}"}], "}"}]}]}], "/.", 
        RowBox[{"w", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"{", "w1", "}"}], "}"}]}]}], "/.", 
       RowBox[{"l", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"{", "l1", "}"}], "}"}]}]}], "/.", 
      RowBox[{"n", "\[Rule]", "1"}]}], " ", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"v1", ">", "0"}], ",", 
       RowBox[{"w1", ">", "0"}], ",", " ", 
       RowBox[{"sigmaG", ">", "0"}], ",", 
       RowBox[{"sigmaI", ">", "0"}], ",", 
       RowBox[{"sigmaS", ">", "0"}]}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7167293585192423`*^9, 3.716729364710959*^9}, {
  3.716729431049589*^9, 3.7167295108665333`*^9}, {3.716729592589325*^9, 
  3.716729620214271*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"{", 
    RowBox[{"{", 
     FractionBox[
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox["l1", "2"], 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["sigmaG", "2"], "+", 
            RowBox[{
             SuperscriptBox["sigmaS", "2"], " ", 
             SuperscriptBox["v1", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["sigmaI", "2"], " ", 
             SuperscriptBox["w1", "2"]}]}], ")"}]}]]}]], 
      RowBox[{
       SqrtBox[
        RowBox[{"2", " ", "\[Pi]"}]], " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["sigmaG", "2"], "+", 
         RowBox[{
          SuperscriptBox["sigmaS", "2"], " ", 
          SuperscriptBox["v1", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["sigmaI", "2"], " ", 
          SuperscriptBox["w1", "2"]}]}]]}]], "}"}], "}"}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.7167294547767057`*^9, 3.716729512574315*^9}, {
   3.716729578319992*^9, 3.716729620721644*^9}, 3.717010258401822*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"equation", " ", "39"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"equation$38$integrand", " ", "=", " ", 
   RowBox[{"p$s", " ", "p$l$s", " ", "equation$22"}]}]}]], "Input",
 CellChangeTimes->{{3.7167322967822227`*^9, 3.7167322980070057`*^9}, {
  3.717009379658503*^9, 3.717009443876896*^9}, {3.7170095550334053`*^9, 
  3.717009657779018*^9}, {3.7170102687462263`*^9, 3.717010309836418*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{
    SqrtBox[
     SuperscriptBox["sigmaS", "2"]], " ", 
    SqrtBox[
     RowBox[{
      SuperscriptBox["sigmaG", "2"], "+", 
      RowBox[{
       SuperscriptBox["sigmaI", "2"], " ", "w2"}]}]]}]], 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox["s", "2"], 
       RowBox[{"2", " ", 
        SuperscriptBox["sigmaS", "2"]}]]}], "-", 
     FractionBox[
      RowBox[{"l2", "+", 
       RowBox[{"s", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "lv11"}], "+", 
          RowBox[{"s", " ", "v2"}]}], ")"}]}], "-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["sigmaI", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"lw11", "-", 
            RowBox[{"s", " ", "vw11"}]}], ")"}], "2"]}], 
        RowBox[{
         SuperscriptBox["sigmaG", "2"], "+", 
         RowBox[{
          SuperscriptBox["sigmaI", "2"], " ", "w2"}]}]]}], 
      RowBox[{"2", " ", 
       SuperscriptBox["sigmaG", "2"]}]]}]], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"2", " ", "\[Pi]"}], ")"}], 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "2"]}], "-", 
     FractionBox["n", "2"]}]], " ", 
   SuperscriptBox["sigmaG", 
    RowBox[{"1", "-", "n"}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"s", " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox["lv11", 
         SuperscriptBox["sigmaG", "2"]], "-", 
        FractionBox[
         RowBox[{"lw11", " ", 
          SuperscriptBox["sigmaI", "2"], " ", "vw11"}], 
         RowBox[{
          SuperscriptBox["sigmaG", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["sigmaG", "2"], "+", 
            RowBox[{
             SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}]}]]}], 
       ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["s", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["v2", 
          RowBox[{"2", " ", 
           SuperscriptBox["sigmaG", "2"]}]]}], "+", 
        FractionBox[
         RowBox[{
          SuperscriptBox["sigmaI", "2"], " ", 
          SuperscriptBox["vw11", "2"]}], 
         RowBox[{"2", " ", 
          SuperscriptBox["sigmaG", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["sigmaG", "2"], "+", 
            RowBox[{
             SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}]}]]}], 
       ")"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.717010311420907*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Integrate", "[", 
  RowBox[{"equation$38$integrand", ",", " ", 
   RowBox[{"{", 
    RowBox[{"s", ",", 
     RowBox[{"-", "Infinity"}], ",", "Infinity"}], "}"}], ",", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"sigmaI", ">", "0"}], ",", " ", 
      RowBox[{"sigmaG", ">", "0"}], ",", " ", 
      RowBox[{"sigmaS", ">", "0"}], ",", " ", 
      RowBox[{"v2", ">", "0"}], ",", " ", 
      RowBox[{"w2", ">", "0"}], ",", " ", 
      RowBox[{
       RowBox[{"v2", " ", "w2"}], ">", 
       RowBox[{"vw11", "^", "2"}]}]}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.717010313397376*^9, 3.7170103547898903`*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["2", 
       RowBox[{
        FractionBox["1", "2"], "+", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "3"}], "-", "n"}], ")"}]}]}]], " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{"l2", "-", 
          FractionBox[
           RowBox[{
            SuperscriptBox["lw11", "2"], " ", 
            SuperscriptBox["sigmaI", "2"]}], 
           RowBox[{
            SuperscriptBox["sigmaG", "2"], "+", 
            RowBox[{
             SuperscriptBox["sigmaI", "2"], " ", "w2"}]}]], "-", 
          FractionBox[
           RowBox[{
            SuperscriptBox["sigmaS", "2"], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"lw11", " ", 
                SuperscriptBox["sigmaI", "2"], " ", "vw11"}], "-", 
               RowBox[{"lv11", " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["sigmaG", "2"], "+", 
                  RowBox[{
                   SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}]}]}], 
              ")"}], "2"]}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["sigmaG", "2"], "+", 
              RowBox[{
               SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["sigmaG", "4"], "+", 
              RowBox[{
               SuperscriptBox["sigmaG", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox["sigmaS", "2"], " ", "v2"}], "+", 
                 RowBox[{
                  SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}]}], "+", 
              
              RowBox[{
               SuperscriptBox["sigmaI", "2"], " ", 
               SuperscriptBox["sigmaS", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  SuperscriptBox["vw11", "2"]}], "+", 
                 RowBox[{"v2", " ", "w2"}]}], ")"}]}]}], ")"}]}]]}], 
         RowBox[{"2", " ", 
          SuperscriptBox["sigmaG", "2"]}]]}]], " ", 
      SuperscriptBox["\[Pi]", 
       RowBox[{
        FractionBox["1", "2"], "+", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "-", "n"}], ")"}]}]}]], " ", 
      SuperscriptBox["sigmaG", 
       RowBox[{"-", "n"}]], " ", 
      SuperscriptBox["sigmaS", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["sigmaG", "10"], " ", "v2"}], "+", 
        RowBox[{
         SuperscriptBox["lw11", "2"], " ", 
         SuperscriptBox["sigmaI", "6"], " ", 
         SuperscriptBox["sigmaS", "2"], " ", 
         SuperscriptBox["vw11", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["vw11", "2"], "-", 
           RowBox[{"v2", " ", "w2"}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["sigmaG", "6"], " ", 
         SuperscriptBox["sigmaI", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["sigmaS", "2"], " ", "v2"}], "+", 
           RowBox[{
            SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", 
            SuperscriptBox["vw11", "2"]}], "+", 
           RowBox[{"3", " ", "v2", " ", "w2"}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["sigmaG", "8"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["sigmaS", "2"], " ", 
            SuperscriptBox["v2", "2"]}], "-", 
           RowBox[{
            SuperscriptBox["sigmaI", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["vw11", "2"], "-", 
              RowBox[{"3", " ", "v2", " ", "w2"}]}], ")"}]}]}], ")"}]}], "+", 
        
        RowBox[{
         SuperscriptBox["sigmaG", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["lw11", "2"]}], " ", 
            SuperscriptBox["sigmaI", "4"], " ", 
            SuperscriptBox["vw11", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["sigmaS", "2"], " ", "v2"}], "+", 
              RowBox[{"2", " ", 
               SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["sigmaI", "6"], " ", 
            SuperscriptBox["sigmaS", "2"], " ", "w2", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["vw11", "2"], "-", 
               RowBox[{"v2", " ", "w2"}]}], ")"}], "2"]}]}], ")"}]}], "+", 
        RowBox[{"2", " ", "lv11", " ", "lw11", " ", 
         SuperscriptBox["sigmaI", "2"], " ", "vw11", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["sigmaG", "2"], "+", 
           RowBox[{
            SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["sigmaG", "4"]}], "+", 
           RowBox[{
            SuperscriptBox["sigmaG", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["sigmaS", "2"], " ", "v2"}], "+", 
              RowBox[{"2", " ", 
               SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["sigmaI", "2"], " ", 
            SuperscriptBox["sigmaS", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", 
               SuperscriptBox["vw11", "2"]}], "+", 
              RowBox[{"v2", " ", "w2"}]}], ")"}]}]}], ")"}]}], "-", 
        RowBox[{
         SuperscriptBox["lv11", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["sigmaG", "2"], "+", 
            RowBox[{
             SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["sigmaG", "4"]}], "+", 
           RowBox[{
            SuperscriptBox["sigmaG", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["sigmaS", "2"], " ", "v2"}], "+", 
              RowBox[{"2", " ", 
               SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["sigmaI", "2"], " ", 
            SuperscriptBox["sigmaS", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", 
               SuperscriptBox["vw11", "2"]}], "+", 
              RowBox[{"v2", " ", "w2"}]}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["sigmaG", "4"], " ", 
         SuperscriptBox["sigmaI", "4"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", 
            SuperscriptBox["lw11", "2"], " ", 
            SuperscriptBox["vw11", "2"]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["vw11", "2"], "-", 
              RowBox[{"v2", " ", "w2"}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                SuperscriptBox["sigmaI", "2"]}], " ", 
               SuperscriptBox["w2", "2"]}], "+", 
              RowBox[{
               SuperscriptBox["sigmaS", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["vw11", "2"], "-", 
                 RowBox[{"3", " ", "v2", " ", "w2"}]}], ")"}]}]}], ")"}]}]}], 
          ")"}]}]}], ")"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["sigmaG", "2"], "+", 
        RowBox[{
         SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["sigmaG", "4"], "+", 
         RowBox[{
          SuperscriptBox["sigmaG", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["sigmaS", "2"], " ", "v2"}], "+", 
            RowBox[{
             SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["sigmaI", "2"], " ", 
          SuperscriptBox["sigmaS", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["vw11", "2"]}], "+", 
            RowBox[{"v2", " ", "w2"}]}], ")"}]}]}], ")"}], 
       RowBox[{"5", "/", "2"}]]}], ")"}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.7170106098786383`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"%", "/.", 
   RowBox[{"kappa", "\[Rule]", "k"}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.717010755160619*^9, 3.717010761665024*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   FractionBox["1", 
    RowBox[{
     SuperscriptBox["k", 
      RowBox[{"5", "/", "2"}]], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["sigmaG", "2"], "+", 
       RowBox[{
        SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}]}]], 
   RowBox[{
    SuperscriptBox["2", 
     RowBox[{
      RowBox[{"-", "1"}], "-", 
      FractionBox["n", "2"]}]], " ", 
    SuperscriptBox["\[ExponentialE]", 
     FractionBox[
      RowBox[{
       RowBox[{"k", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["lw11", "2"], " ", 
           SuperscriptBox["sigmaI", "2"]}], "-", 
          RowBox[{"l2", " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["sigmaG", "2"], "+", 
             RowBox[{
              SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}]}]}], 
         ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["sigmaS", "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"lw11", " ", 
            SuperscriptBox["sigmaI", "2"], " ", "vw11"}], "-", 
           RowBox[{"lv11", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["sigmaG", "2"], "+", 
              RowBox[{
               SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}]}]}], ")"}],
          "2"]}]}], 
      RowBox[{"2", " ", "k", " ", 
       SuperscriptBox["sigmaG", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["sigmaG", "2"], "+", 
         RowBox[{
          SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}]}]]], " ", 
    SuperscriptBox["\[Pi]", 
     RowBox[{
      RowBox[{"-", "n"}], "/", "2"}]], " ", 
    SuperscriptBox["sigmaG", 
     RowBox[{"-", "n"}]], " ", 
    SuperscriptBox["sigmaS", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["sigmaG", "10"], " ", "v2"}], "+", 
      RowBox[{
       SuperscriptBox["lw11", "2"], " ", 
       SuperscriptBox["sigmaI", "6"], " ", 
       SuperscriptBox["sigmaS", "2"], " ", 
       SuperscriptBox["vw11", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["vw11", "2"], "-", 
         RowBox[{"v2", " ", "w2"}]}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox["sigmaG", "6"], " ", 
       SuperscriptBox["sigmaI", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["sigmaS", "2"], " ", "v2"}], "+", 
         RowBox[{
          SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", 
          SuperscriptBox["vw11", "2"]}], "+", 
         RowBox[{"3", " ", "v2", " ", "w2"}]}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox["sigmaG", "8"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["sigmaS", "2"], " ", 
          SuperscriptBox["v2", "2"]}], "-", 
         RowBox[{
          SuperscriptBox["sigmaI", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["vw11", "2"], "-", 
            RowBox[{"3", " ", "v2", " ", "w2"}]}], ")"}]}]}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox["sigmaG", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["lw11", "2"]}], " ", 
          SuperscriptBox["sigmaI", "4"], " ", 
          SuperscriptBox["vw11", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["sigmaS", "2"], " ", "v2"}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["sigmaI", "6"], " ", 
          SuperscriptBox["sigmaS", "2"], " ", "w2", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["vw11", "2"], "-", 
             RowBox[{"v2", " ", "w2"}]}], ")"}], "2"]}]}], ")"}]}], "+", 
      RowBox[{"2", " ", "lv11", " ", "lw11", " ", 
       SuperscriptBox["sigmaI", "2"], " ", "vw11", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["sigmaG", "2"], "+", 
         RowBox[{
          SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          SuperscriptBox["sigmaG", "4"]}], "+", 
         RowBox[{
          SuperscriptBox["sigmaG", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["sigmaS", "2"], " ", "v2"}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["sigmaI", "2"], " ", 
          SuperscriptBox["sigmaS", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["vw11", "2"]}], "+", 
            RowBox[{"v2", " ", "w2"}]}], ")"}]}]}], ")"}]}], "-", 
      RowBox[{
       SuperscriptBox["lv11", "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["sigmaG", "2"], "+", 
          RowBox[{
           SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          SuperscriptBox["sigmaG", "4"]}], "+", 
         RowBox[{
          SuperscriptBox["sigmaG", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["sigmaS", "2"], " ", "v2"}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["sigmaI", "2"], " ", 
          SuperscriptBox["sigmaS", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["vw11", "2"]}], "+", 
            RowBox[{"v2", " ", "w2"}]}], ")"}]}]}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox["sigmaG", "4"], " ", 
       SuperscriptBox["sigmaI", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", 
          SuperscriptBox["lw11", "2"], " ", 
          SuperscriptBox["vw11", "2"]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["vw11", "2"], "-", 
            RowBox[{"v2", " ", "w2"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox["sigmaI", "2"]}], " ", 
             SuperscriptBox["w2", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["sigmaS", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["vw11", "2"], "-", 
               RowBox[{"3", " ", "v2", " ", "w2"}]}], ")"}]}]}], ")"}]}]}], 
        ")"}]}]}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{3.71701076335235*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Collect", "[", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"k", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["lw11", "2"], " ", 
         SuperscriptBox["sigmaI", "2"]}], "-", 
        RowBox[{"l2", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["sigmaG", "2"], "+", 
           RowBox[{
            SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}]}]}], ")"}]}], 
     "+", 
     RowBox[{
      SuperscriptBox["sigmaS", "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"lw11", " ", 
          SuperscriptBox["sigmaI", "2"], " ", "vw11"}], "-", 
         RowBox[{"lv11", " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["sigmaG", "2"], "+", 
            RowBox[{
             SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}]}]}], ")"}], 
       "2"]}]}], 
    RowBox[{"2", " ", "k", " ", 
     SuperscriptBox["sigmaG", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["sigmaG", "2"], "+", 
       RowBox[{
        SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}]}]], ",", 
   RowBox[{"{", 
    RowBox[{"l2", ",", " ", 
     RowBox[{"lw11", "^", "2"}], ",", " ", 
     RowBox[{"lv11", "^", "2"}], ",", " ", 
     RowBox[{"lw11", " ", "lv11"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.717011232521185*^9, 3.717011266487175*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["l2", 
    RowBox[{"2", " ", 
     SuperscriptBox["sigmaG", "2"]}]]}], "-", 
  FractionBox[
   RowBox[{"lv11", " ", "lw11", " ", 
    SuperscriptBox["sigmaI", "2"], " ", 
    SuperscriptBox["sigmaS", "2"], " ", "vw11"}], 
   RowBox[{"k", " ", 
    SuperscriptBox["sigmaG", "2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["lw11", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"k", " ", 
       SuperscriptBox["sigmaI", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["sigmaI", "4"], " ", 
       SuperscriptBox["sigmaS", "2"], " ", 
       SuperscriptBox["vw11", "2"]}]}], ")"}]}], 
   RowBox[{"2", " ", "k", " ", 
    SuperscriptBox["sigmaG", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["sigmaG", "2"], "+", 
      RowBox[{
       SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["lv11", "2"], " ", 
    SuperscriptBox["sigmaS", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["sigmaG", "2"], "+", 
      RowBox[{
       SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}]}], 
   RowBox[{"2", " ", "k", " ", 
    SuperscriptBox["sigmaG", "2"]}]]}]], "Output",
 CellChangeTimes->{{3.717011228419921*^9, 3.717011266845168*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"%33", ",", " ", 
      RowBox[{"lw11", "^", "2"}]}], "]"}], "/.", 
    RowBox[{"k", "\[Rule]", "kappa"}]}], "//", 
   RowBox[{"Simplify", "/.", 
    RowBox[{"kappa", "\[Rule]", "k"}]}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.7170114144477663`*^9, 3.7170114434921227`*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["sigmaI", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["sigmaG", "2"], "+", 
     RowBox[{
      SuperscriptBox["sigmaS", "2"], " ", "v2"}]}], ")"}]}], 
  RowBox[{"2", " ", 
   SuperscriptBox["sigmaG", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["sigmaG", "4"], "+", 
     RowBox[{
      SuperscriptBox["sigmaG", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["sigmaS", "2"], " ", "v2"}], "+", 
        RowBox[{
         SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["sigmaI", "2"], " ", 
      SuperscriptBox["sigmaS", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["vw11", "2"]}], "+", 
        RowBox[{"v2", " ", "w2"}]}], ")"}]}]}], ")"}]}]]], "Output",
 CellChangeTimes->{{3.717011419357579*^9, 3.717011443683402*^9}, 
   3.7170114795230103`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"%40", "/.", 
   RowBox[{"kappa", "\[Rule]", "k"}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.717011453587881*^9, 3.71701148476502*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["sigmaI", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["sigmaG", "2"], "+", 
     RowBox[{
      SuperscriptBox["sigmaS", "2"], " ", "v2"}]}], ")"}]}], 
  RowBox[{"2", " ", "k", " ", 
   SuperscriptBox["sigmaG", "2"]}]]], "Output",
 CellChangeTimes->{{3.7170114542041187`*^9, 3.717011485197257*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Collect", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["sigmaG", "10"], " ", "v2"}], "+", 
     RowBox[{
      SuperscriptBox["lw11", "2"], " ", 
      SuperscriptBox["sigmaI", "6"], " ", 
      SuperscriptBox["sigmaS", "2"], " ", 
      SuperscriptBox["vw11", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["vw11", "2"], "-", 
        RowBox[{"v2", " ", "w2"}]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["sigmaG", "6"], " ", 
      SuperscriptBox["sigmaI", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["sigmaS", "2"], " ", "v2"}], "+", 
        RowBox[{
         SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         SuperscriptBox["vw11", "2"]}], "+", 
        RowBox[{"3", " ", "v2", " ", "w2"}]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["sigmaG", "8"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["sigmaS", "2"], " ", 
         SuperscriptBox["v2", "2"]}], "-", 
        RowBox[{
         SuperscriptBox["sigmaI", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["vw11", "2"], "-", 
           RowBox[{"3", " ", "v2", " ", "w2"}]}], ")"}]}]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["sigmaG", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["lw11", "2"]}], " ", 
         SuperscriptBox["sigmaI", "4"], " ", 
         SuperscriptBox["vw11", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["sigmaS", "2"], " ", "v2"}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["sigmaI", "6"], " ", 
         SuperscriptBox["sigmaS", "2"], " ", "w2", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["vw11", "2"], "-", 
            RowBox[{"v2", " ", "w2"}]}], ")"}], "2"]}]}], ")"}]}], "+", 
     RowBox[{"2", " ", "lv11", " ", "lw11", " ", 
      SuperscriptBox["sigmaI", "2"], " ", "vw11", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["sigmaG", "2"], "+", 
        RowBox[{
         SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         SuperscriptBox["sigmaG", "4"]}], "+", 
        RowBox[{
         SuperscriptBox["sigmaG", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["sigmaS", "2"], " ", "v2"}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["sigmaI", "2"], " ", 
         SuperscriptBox["sigmaS", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["vw11", "2"]}], "+", 
           RowBox[{"v2", " ", "w2"}]}], ")"}]}]}], ")"}]}], "-", 
     RowBox[{
      SuperscriptBox["lv11", "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["sigmaG", "2"], "+", 
         RowBox[{
          SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         SuperscriptBox["sigmaG", "4"]}], "+", 
        RowBox[{
         SuperscriptBox["sigmaG", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["sigmaS", "2"], " ", "v2"}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["sigmaI", "2"], " ", 
         SuperscriptBox["sigmaS", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["vw11", "2"]}], "+", 
           RowBox[{"v2", " ", "w2"}]}], ")"}]}]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["sigmaG", "4"], " ", 
      SuperscriptBox["sigmaI", "4"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         SuperscriptBox["lw11", "2"], " ", 
         SuperscriptBox["vw11", "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["vw11", "2"], "-", 
           RowBox[{"v2", " ", "w2"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["sigmaI", "2"]}], " ", 
            SuperscriptBox["w2", "2"]}], "+", 
           RowBox[{
            SuperscriptBox["sigmaS", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["vw11", "2"], "-", 
              RowBox[{"3", " ", "v2", " ", "w2"}]}], ")"}]}]}], ")"}]}]}], 
       ")"}]}]}], ")"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"lw11", "^", "2"}], ",", " ", 
     RowBox[{"lv11", "^", "2"}], ",", " ", 
     RowBox[{"lv11", " ", "lw11"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.71701156716999*^9, 3.71701157723531*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["sigmaG", "10"], " ", "v2"}], "+", 
  RowBox[{
   SuperscriptBox["sigmaG", "2"], " ", 
   SuperscriptBox["sigmaI", "6"], " ", 
   SuperscriptBox["sigmaS", "2"], " ", "w2", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["vw11", "2"], "-", 
      RowBox[{"v2", " ", "w2"}]}], ")"}], "2"]}], "+", 
  RowBox[{
   SuperscriptBox["sigmaG", "6"], " ", 
   SuperscriptBox["sigmaI", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["sigmaS", "2"], " ", "v2"}], "+", 
     RowBox[{
      SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", 
      SuperscriptBox["vw11", "2"]}], "+", 
     RowBox[{"3", " ", "v2", " ", "w2"}]}], ")"}]}], "+", 
  RowBox[{
   SuperscriptBox["sigmaG", "8"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["sigmaS", "2"], " ", 
      SuperscriptBox["v2", "2"]}], "-", 
     RowBox[{
      SuperscriptBox["sigmaI", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["vw11", "2"], "-", 
        RowBox[{"3", " ", "v2", " ", "w2"}]}], ")"}]}]}], ")"}]}], "+", 
  RowBox[{
   SuperscriptBox["sigmaG", "4"], " ", 
   SuperscriptBox["sigmaI", "4"], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["vw11", "2"], "-", 
     RowBox[{"v2", " ", "w2"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["sigmaI", "2"]}], " ", 
      SuperscriptBox["w2", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["sigmaS", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["vw11", "2"], "-", 
        RowBox[{"3", " ", "v2", " ", "w2"}]}], ")"}]}]}], ")"}]}], "+", 
  RowBox[{
   SuperscriptBox["lw11", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", 
      SuperscriptBox["sigmaG", "4"], " ", 
      SuperscriptBox["sigmaI", "4"], " ", 
      SuperscriptBox["vw11", "2"]}], "-", 
     RowBox[{
      SuperscriptBox["sigmaG", "2"], " ", 
      SuperscriptBox["sigmaI", "4"], " ", 
      SuperscriptBox["vw11", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["sigmaS", "2"], " ", "v2"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["sigmaI", "6"], " ", 
      SuperscriptBox["sigmaS", "2"], " ", 
      SuperscriptBox["vw11", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["vw11", "2"], "-", 
        RowBox[{"v2", " ", "w2"}]}], ")"}]}]}], ")"}]}], "+", 
  RowBox[{"2", " ", "lv11", " ", "lw11", " ", 
   SuperscriptBox["sigmaI", "2"], " ", "vw11", " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["sigmaG", "2"], "+", 
     RowBox[{
      SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", 
      SuperscriptBox["sigmaG", "4"]}], "+", 
     RowBox[{
      SuperscriptBox["sigmaG", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["sigmaS", "2"], " ", "v2"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["sigmaI", "2"], " ", 
      SuperscriptBox["sigmaS", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["vw11", "2"]}], "+", 
        RowBox[{"v2", " ", "w2"}]}], ")"}]}]}], ")"}]}], "-", 
  RowBox[{
   SuperscriptBox["lv11", "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["sigmaG", "2"], "+", 
      RowBox[{
       SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", 
      SuperscriptBox["sigmaG", "4"]}], "+", 
     RowBox[{
      SuperscriptBox["sigmaG", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["sigmaS", "2"], " ", "v2"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["sigmaI", "2"], " ", 
      SuperscriptBox["sigmaS", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["vw11", "2"]}], "+", 
        RowBox[{"v2", " ", "w2"}]}], ")"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.717011563438656*^9, 3.717011577769573*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gamma", " ", "=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{"Expand", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{"sigmaG", "^", "2"}]}], " ", "+", " ", 
        RowBox[{
         RowBox[{"sigmaS", "^", "2"}], " ", "v2"}]}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"sigmaG", "^", "2"}], " ", "+", " ", 
        RowBox[{
         RowBox[{"sigmaI", "^", "2"}], " ", "w2"}]}], ")"}]}], "-", 
     RowBox[{
      RowBox[{"sigmaI", "^", "2"}], " ", 
      RowBox[{"sigmaS", "^", "2"}], " ", 
      RowBox[{"vw11", "^", "2"}]}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.71701176674269*^9, 3.717011777518754*^9}, {
  3.7170118287835493`*^9, 3.717011843112793*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", 
   SuperscriptBox["sigmaG", "4"]}], "+", 
  RowBox[{
   SuperscriptBox["sigmaG", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["sigmaS", "2"], " ", "v2"}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}]}], "+", 
  RowBox[{
   SuperscriptBox["sigmaI", "2"], " ", 
   SuperscriptBox["sigmaS", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["vw11", "2"]}], "+", 
     RowBox[{"v2", " ", "w2"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.717011739345365*^9, 3.717011778031242*^9, {3.717011830170671*^9, 
   3.717011843501326*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Coefficient", "[", 
    RowBox[{"%43", ",", 
     RowBox[{"lw11", "^", "2"}]}], "]"}], "*", 
   RowBox[{"-", "1"}]}], "//", "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Coefficient", "[", 
   RowBox[{"%43", ",", 
    RowBox[{"lv11", "^", "2"}]}], "]"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Coefficient", "[", 
   RowBox[{"%43", ",", 
    RowBox[{"lw11", " ", "lv11"}]}], "]"}], "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.71701158460366*^9, 3.717011644571134*^9}, {
  3.7170117412624073`*^9, 3.717011744284539*^9}, {3.7170118484898853`*^9, 
  3.7170118776682787`*^9}, {3.717011993174048*^9, 3.717011993523973*^9}}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["sigmaI", "4"], " ", 
  SuperscriptBox["vw11", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", " ", 
     SuperscriptBox["sigmaG", "4"]}], "+", 
    RowBox[{
     SuperscriptBox["sigmaG", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["sigmaS", "2"], " ", "v2"}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox["sigmaI", "2"], " ", 
     SuperscriptBox["sigmaS", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["vw11", "2"]}], "+", 
       RowBox[{"v2", " ", "w2"}]}], ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.717011595874302*^9, {3.7170116343296013`*^9, 3.717011645073503*^9}, 
   3.717011744842914*^9, {3.717011785439831*^9, 3.717011786819812*^9}, {
   3.7170118499869757`*^9, 3.717011878593315*^9}, 3.7170119938827543`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["sigmaG", "2"], "+", 
      RowBox[{
       SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}], "2"]}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", " ", 
     SuperscriptBox["sigmaG", "4"]}], "+", 
    RowBox[{
     SuperscriptBox["sigmaG", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["sigmaS", "2"], " ", "v2"}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox["sigmaI", "2"], " ", 
     SuperscriptBox["sigmaS", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["vw11", "2"]}], "+", 
       RowBox[{"v2", " ", "w2"}]}], ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.717011595874302*^9, {3.7170116343296013`*^9, 3.717011645073503*^9}, 
   3.717011744842914*^9, {3.717011785439831*^9, 3.717011786819812*^9}, {
   3.7170118499869757`*^9, 3.717011878593315*^9}, 3.71701199389774*^9}],

Cell[BoxData[
 RowBox[{"2", " ", 
  SuperscriptBox["sigmaI", "2"], " ", "vw11", " ", 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["sigmaG", "2"], "+", 
    RowBox[{
     SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", " ", 
     SuperscriptBox["sigmaG", "4"]}], "+", 
    RowBox[{
     SuperscriptBox["sigmaG", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["sigmaS", "2"], " ", "v2"}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox["sigmaI", "2"], " ", 
     SuperscriptBox["sigmaS", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["vw11", "2"]}], "+", 
       RowBox[{"v2", " ", "w2"}]}], ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.717011595874302*^9, {3.7170116343296013`*^9, 3.717011645073503*^9}, 
   3.717011744842914*^9, {3.717011785439831*^9, 3.717011786819812*^9}, {
   3.7170118499869757`*^9, 3.717011878593315*^9}, 3.717011993908288*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"%88", "/.", 
     RowBox[{"gamma", "\[Rule]", "g"}]}], ")"}], "*", 
   RowBox[{"-", "1"}]}], "//", "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{"%89", "/.", 
  RowBox[{"gamma", "\[Rule]", "g"}]}], "\[IndentingNewLine]", 
 RowBox[{"%90", "/.", 
  RowBox[{"gamma", "\[Rule]", "g"}]}]}], "Input",
 CellChangeTimes->{{3.717011986163988*^9, 3.717012035485038*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "g"}], " ", 
  SuperscriptBox["sigmaI", "4"], " ", 
  SuperscriptBox["vw11", "2"]}]], "Output",
 CellChangeTimes->{{3.717011989617922*^9, 3.717012035847114*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "g"}], " ", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["sigmaG", "2"], "+", 
     RowBox[{
      SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}], "2"]}]], "Output",
 CellChangeTimes->{{3.717011989617922*^9, 3.717012035855062*^9}}],

Cell[BoxData[
 RowBox[{"2", " ", "g", " ", 
  SuperscriptBox["sigmaI", "2"], " ", "vw11", " ", 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["sigmaG", "2"], "+", 
    RowBox[{
     SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.717011989617922*^9, 3.7170120358597813`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     SuperscriptBox["sigmaG", "10"], " ", "v2"}], "+", 
    RowBox[{
     SuperscriptBox["sigmaG", "2"], " ", 
     SuperscriptBox["sigmaI", "6"], " ", 
     SuperscriptBox["sigmaS", "2"], " ", "w2", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["vw11", "2"], "-", 
        RowBox[{"v2", " ", "w2"}]}], ")"}], "2"]}], "+", 
    RowBox[{
     SuperscriptBox["sigmaG", "6"], " ", 
     SuperscriptBox["sigmaI", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["sigmaS", "2"], " ", "v2"}], "+", 
       RowBox[{
        SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", 
        SuperscriptBox["vw11", "2"]}], "+", 
       RowBox[{"3", " ", "v2", " ", "w2"}]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox["sigmaG", "8"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["sigmaS", "2"], " ", 
        SuperscriptBox["v2", "2"]}], "-", 
       RowBox[{
        SuperscriptBox["sigmaI", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["vw11", "2"], "-", 
          RowBox[{"3", " ", "v2", " ", "w2"}]}], ")"}]}]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox["sigmaG", "4"], " ", 
     SuperscriptBox["sigmaI", "4"], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["vw11", "2"], "-", 
       RowBox[{"v2", " ", "w2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["sigmaI", "2"]}], " ", 
        SuperscriptBox["w2", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["sigmaS", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["vw11", "2"], "-", 
          RowBox[{"3", " ", "v2", " ", "w2"}]}], ")"}]}]}], ")"}]}]}], "]"}], 
  "/.", 
  RowBox[{"kappa", "\[Rule]", "k"}]}]], "Input",
 CellChangeTimes->{{3.7170122252667913`*^9, 3.717012248107314*^9}}],

Cell[BoxData[
 RowBox[{"k", " ", 
  SuperscriptBox["sigmaG", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["sigmaG", "2"], "+", 
    RowBox[{
     SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     SuperscriptBox["sigmaG", "2"], " ", "v2"}], "+", 
    RowBox[{
     SuperscriptBox["sigmaI", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["vw11", "2"]}], "+", 
       RowBox[{"v2", " ", "w2"}]}], ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.717012230826845*^9, 3.717012248554255*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%43", "-", 
  RowBox[{
   RowBox[{"lw11", "^", "2"}], " ", 
   RowBox[{"Coefficient", "[", 
    RowBox[{"%43", ",", " ", 
     RowBox[{"lw11", "^", "2"}]}], "]"}]}], "-", 
  RowBox[{
   RowBox[{"lv11", "^", "2"}], " ", 
   RowBox[{"Coefficient", "[", 
    RowBox[{"%43", ",", " ", 
     RowBox[{"lv11", "^", "2"}]}], "]"}]}], "-", 
  RowBox[{"lv11", " ", "lw11", " ", 
   RowBox[{"Coefficient", "[", 
    RowBox[{"%43", ",", " ", 
     RowBox[{"lv11", " ", "lw11"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.717012295477396*^9, 3.717012339637712*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["sigmaG", "10"], " ", "v2"}], "+", 
  RowBox[{
   SuperscriptBox["sigmaG", "2"], " ", 
   SuperscriptBox["sigmaI", "6"], " ", 
   SuperscriptBox["sigmaS", "2"], " ", "w2", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["vw11", "2"], "-", 
      RowBox[{"v2", " ", "w2"}]}], ")"}], "2"]}], "+", 
  RowBox[{
   SuperscriptBox["sigmaG", "6"], " ", 
   SuperscriptBox["sigmaI", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["sigmaS", "2"], " ", "v2"}], "+", 
     RowBox[{
      SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", 
      SuperscriptBox["vw11", "2"]}], "+", 
     RowBox[{"3", " ", "v2", " ", "w2"}]}], ")"}]}], "+", 
  RowBox[{
   SuperscriptBox["sigmaG", "8"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["sigmaS", "2"], " ", 
      SuperscriptBox["v2", "2"]}], "-", 
     RowBox[{
      SuperscriptBox["sigmaI", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["vw11", "2"], "-", 
        RowBox[{"3", " ", "v2", " ", "w2"}]}], ")"}]}]}], ")"}]}], "+", 
  RowBox[{
   SuperscriptBox["sigmaG", "4"], " ", 
   SuperscriptBox["sigmaI", "4"], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["vw11", "2"], "-", 
     RowBox[{"v2", " ", "w2"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["sigmaI", "2"]}], " ", 
      SuperscriptBox["w2", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["sigmaS", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["vw11", "2"], "-", 
        RowBox[{"3", " ", "v2", " ", "w2"}]}], ")"}]}]}], ")"}]}]}]], "Output",\

 CellChangeTimes->{3.71701234008259*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"FullSimplify", "[", "%", "]"}], "/.", 
  RowBox[{"kappa", "\[Rule]", "k"}]}]], "Input",
 CellChangeTimes->{{3.717012342639412*^9, 3.7170123519898443`*^9}}],

Cell[BoxData[
 RowBox[{"k", " ", 
  SuperscriptBox["sigmaG", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["sigmaG", "2"], "+", 
    RowBox[{
     SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     SuperscriptBox["sigmaG", "2"], " ", "v2"}], "+", 
    RowBox[{
     SuperscriptBox["sigmaI", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["vw11", "2"]}], "+", 
       RowBox[{"v2", " ", "w2"}]}], ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.7170123452599287`*^9, 3.717012352894685*^9}}]
}, Open  ]]
},
WindowSize->{1080, 1875},
WindowMargins->{{Automatic, -1080}, {Automatic, -1}},
FrontEndVersion->"11.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 1199, 36, 75, "Input"],
Cell[1782, 60, 331, 9, 60, "Output"],
Cell[2116, 71, 600, 18, 73, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2753, 94, 675, 19, 75, "Input"],
Cell[3431, 115, 115, 2, 32, "Output"],
Cell[3549, 119, 117, 2, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3703, 126, 1845, 54, 75, "Input"],
Cell[5551, 182, 1215, 39, 51, "Output"],
Cell[6769, 223, 1105, 36, 51, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7911, 264, 1403, 35, 117, "Input"],
Cell[9317, 301, 1310, 40, 86, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10664, 346, 1299, 34, 96, "Input"],
Cell[11966, 382, 887, 27, 77, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12890, 414, 536, 15, 54, "Input"],
Cell[13429, 431, 1222, 39, 86, "Output"],
Cell[14654, 472, 439, 14, 73, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15130, 491, 1072, 26, 96, "Input"],
Cell[16205, 519, 3288, 96, 150, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19530, 620, 891, 24, 54, "Input"],
Cell[20424, 646, 647, 20, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21108, 671, 725, 18, 54, "Input"],
Cell[21836, 691, 1289, 38, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23162, 734, 1424, 38, 96, "Input"],
Cell[24589, 774, 987, 31, 76, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25613, 810, 619, 14, 32, "Input"],
Cell[26235, 826, 1877, 56, 106, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28149, 887, 1668, 43, 117, "Input"],
Cell[29820, 932, 1338, 43, 89, "Output"],
Cell[31161, 977, 1397, 45, 75, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32595, 1027, 145, 2, 32, "Input"],
Cell[32743, 1031, 1777, 54, 106, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34557, 1090, 801, 19, 54, "Input"],
Cell[35361, 1111, 2919, 94, 147, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38317, 1210, 1357, 33, 96, "Input"],
Cell[39677, 1245, 493, 14, 51, "Output"],
Cell[40173, 1261, 288, 8, 51, "Output"],
Cell[40464, 1271, 421, 13, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40922, 1289, 621, 16, 54, "Input"],
Cell[41546, 1307, 1161, 39, 54, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42744, 1351, 1954, 50, 96, "Input"],
Cell[44701, 1403, 1022, 30, 35, "Output"],
Cell[45726, 1435, 5070, 145, 185, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[50833, 1585, 1184, 32, 75, "Input"],
Cell[52020, 1619, 1142, 34, 76, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[53199, 1658, 455, 8, 54, "Input"],
Cell[53657, 1668, 2626, 87, 127, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[56320, 1760, 678, 17, 54, "Input"],
Cell[57001, 1779, 9108, 255, 444, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[66146, 2039, 181, 4, 32, "Input"],
Cell[66330, 2045, 6982, 206, 213, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[73349, 2256, 1430, 44, 91, "Input"],
Cell[74782, 2302, 1305, 41, 56, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[76124, 2348, 381, 10, 32, "Input"],
Cell[76508, 2360, 982, 31, 56, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[77527, 2396, 182, 4, 32, "Input"],
Cell[77712, 2402, 373, 11, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[78122, 2418, 5242, 154, 152, "Input"],
Cell[83367, 2574, 4487, 142, 129, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[87891, 2721, 782, 22, 32, "Input"],
Cell[88676, 2745, 684, 22, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[89397, 2772, 717, 18, 75, "Input"],
Cell[90117, 2792, 957, 27, 35, "Output"],
Cell[91077, 2821, 1077, 32, 36, "Output"],
Cell[92157, 2855, 1087, 31, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[93281, 2891, 427, 11, 75, "Input"],
Cell[93711, 2904, 200, 5, 32, "Output"],
Cell[93914, 2911, 299, 9, 36, "Output"],
Cell[94216, 2922, 316, 8, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[94569, 2935, 2072, 64, 80, "Input"],
Cell[96644, 3001, 602, 19, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[97283, 3025, 579, 16, 32, "Input"],
Cell[97865, 3043, 1832, 61, 59, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[99734, 3109, 190, 4, 32, "Input"],
Cell[99927, 3115, 604, 19, 35, "Output"]
}, Open  ]]
}
]
*)

