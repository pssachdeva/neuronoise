(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     28803,        931]
NotebookOptionsPosition[     27167,        870]
NotebookOutlinePosition[     27531,        886]
CellTagsIndexPosition[     27488,        883]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"equation", " ", "4"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"p$xiI", " ", "=", " ", 
    RowBox[{
     RowBox[{"1", "/", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"2", "Pi"}], "]"}]}], " ", 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"xiI", "^", "2"}]}], "/", "2"}], "]"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"p$li$s$xiI", " ", "=", " ", 
    RowBox[{
     RowBox[{"1", "/", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"2", "Pi", " ", 
        RowBox[{"sigmaG", "^", "2"}]}], "]"}]}], " ", 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"li", " ", "-", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"vi", " ", "s"}], " ", "+", " ", 
             RowBox[{"sigmaI", " ", "wi", " ", "xiI"}]}], ")"}]}], ")"}], "^",
          "2"}]}], "/", 
       RowBox[{"(", 
        RowBox[{"2", " ", 
         RowBox[{"sigmaG", "^", "2"}]}], ")"}]}], "]"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.71657081544541*^9, 3.716570867736648*^9}, {
  3.716570935427659*^9, 3.716570967251683*^9}}],

Cell[BoxData[
 FractionBox[
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"-", 
    FractionBox[
     SuperscriptBox["xiI", "2"], "2"]}]], 
  SqrtBox[
   RowBox[{"2", " ", "\[Pi]"}]]]], "Output",
 CellChangeTimes->{3.71657086970155*^9, 3.716570939123817*^9, 
  3.716570969148079*^9}],

Cell[BoxData[
 FractionBox[
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"-", 
    FractionBox[
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"li", "-", 
        RowBox[{"s", " ", "vi"}], "-", 
        RowBox[{"sigmaI", " ", "wi", " ", "xiI"}]}], ")"}], "2"], 
     RowBox[{"2", " ", 
      SuperscriptBox["sigmaG", "2"]}]]}]], 
  RowBox[{
   SqrtBox[
    RowBox[{"2", " ", "\[Pi]"}]], " ", 
   SqrtBox[
    SuperscriptBox["sigmaG", "2"]]}]]], "Output",
 CellChangeTimes->{3.71657086970155*^9, 3.716570939123817*^9, 
  3.716570969153556*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"sanity", " ", "checks", " ", "on", " ", "pdfs"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Integrate", "[", 
    RowBox[{"p$xiI", ",", 
     RowBox[{"{", 
      RowBox[{"xiI", ",", 
       RowBox[{"-", "Infinity"}], ",", "Infinity"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Integrate", "[", 
    RowBox[{"p$li$s$xiI", ",", " ", 
     RowBox[{"{", 
      RowBox[{"li", ",", " ", 
       RowBox[{"-", "Infinity"}], ",", "Infinity"}], "}"}], ",", " ", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"sigmaG", ">", "0"}], "}"}]}]}], "]"}]}]}]], "Input"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{3.716571439444476*^9}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{3.716571440492289*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"equation", " ", "8"}], ",", " ", 
    RowBox[{"exponential", " ", "terms"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"equation$8", " ", "=", " ", 
    RowBox[{"Collect", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"xiI", "^", "2"}]}], "/", "2"}], "-", 
       RowBox[{
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{"2", " ", 
           RowBox[{"sigmaG", "^", "2"}]}], ")"}]}], " ", 
        RowBox[{"Expand", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"li", " ", "-", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"vi", " ", "s"}], " ", "+", " ", 
              RowBox[{"sigmaI", " ", "wi", " ", "xiI"}]}], ")"}]}], ")"}], 
          "^", "2"}], "]"}]}]}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"xiI", ",", " ", 
        RowBox[{"xiI", "^", "2"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
   
   RowBox[{"equation8$mod", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"equation$8", "/.", 
          RowBox[{
           RowBox[{"li", "^", "2"}], "\[Rule]", "l2"}]}], "/.", 
         RowBox[{
          RowBox[{"li", " ", "vi"}], "\[Rule]", "lv11"}]}], "/.", 
        RowBox[{
         RowBox[{"li", " ", "wi"}], "->", "lw11"}]}], "/.", 
       RowBox[{
        RowBox[{"vi", " ", "wi"}], "\[Rule]", " ", "vw11"}]}], " ", "/.", 
      RowBox[{
       RowBox[{"wi", "^", "2"}], " ", "\[Rule]", " ", "w2"}]}], "/.", 
     RowBox[{
      RowBox[{"vi", "^", "2"}], "->", "v2"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.71657129053578*^9, 3.71657135939137*^9}, {
  3.7165714260261087`*^9, 3.71657146142568*^9}, {3.716581886483963*^9, 
  3.7165818866696568`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    SuperscriptBox["li", "2"], 
    RowBox[{"2", " ", 
     SuperscriptBox["sigmaG", "2"]}]]}], "+", 
  FractionBox[
   RowBox[{"li", " ", "s", " ", "vi"}], 
   SuperscriptBox["sigmaG", "2"]], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["s", "2"], " ", 
    SuperscriptBox["vi", "2"]}], 
   RowBox[{"2", " ", 
    SuperscriptBox["sigmaG", "2"]}]], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"li", " ", "sigmaI", " ", "wi"}], 
      SuperscriptBox["sigmaG", "2"]], "-", 
     FractionBox[
      RowBox[{"s", " ", "sigmaI", " ", "vi", " ", "wi"}], 
      SuperscriptBox["sigmaG", "2"]]}], ")"}], " ", "xiI"}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "2"]}], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["sigmaI", "2"], " ", 
       SuperscriptBox["wi", "2"]}], 
      RowBox[{"2", " ", 
       SuperscriptBox["sigmaG", "2"]}]]}], ")"}], " ", 
   SuperscriptBox["xiI", "2"]}]}]], "Output",
 CellChangeTimes->{{3.716571317127162*^9, 3.716571359971375*^9}, 
   3.716571461897168*^9, 3.716581887183813*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["l2", 
    RowBox[{"2", " ", 
     SuperscriptBox["sigmaG", "2"]}]]}], "+", 
  FractionBox[
   RowBox[{"lv11", " ", "s"}], 
   SuperscriptBox["sigmaG", "2"]], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["s", "2"], " ", "v2"}], 
   RowBox[{"2", " ", 
    SuperscriptBox["sigmaG", "2"]}]], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"lw11", " ", "sigmaI"}], 
      SuperscriptBox["sigmaG", "2"]], "-", 
     FractionBox[
      RowBox[{"s", " ", "sigmaI", " ", "vw11"}], 
      SuperscriptBox["sigmaG", "2"]]}], ")"}], " ", "xiI"}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "2"]}], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["sigmaI", "2"], " ", "w2"}], 
      RowBox[{"2", " ", 
       SuperscriptBox["sigmaG", "2"]}]]}], ")"}], " ", 
   SuperscriptBox["xiI", "2"]}]}]], "Output",
 CellChangeTimes->{{3.716571317127162*^9, 3.716571359971375*^9}, 
   3.716571461897168*^9, 3.716581887194559*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"equation", " ", "9"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"equation$9", " ", "=", " ", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"1", "/", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{"2", "Pi", " ", 
          RowBox[{"sigmaG", "^", "2"}]}], "]"}], "^", "n"}]}], " ", "*", " ", 
      
      RowBox[{"1", "/", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"2", "Pi"}], "]"}]}], 
      RowBox[{"Integrate", "[", 
       RowBox[{
        RowBox[{"Exp", "[", "equation8$mod", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"xiI", ",", 
          RowBox[{"-", "Infinity"}], ",", "Infinity"}], "}"}], ",", " ", 
        RowBox[{"Assumptions", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"sigmaG", ">", "0"}], ",", " ", 
           RowBox[{"sigmaI", ">", "0"}], ",", " ", 
           RowBox[{"v2", ">", "0"}], ",", " ", 
           RowBox[{"w2", ">", "0"}]}], "}"}]}]}], "]"}]}], ",", " ", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{"sigmaG", ">", "0"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.716581620493361*^9, 3.716581684253586*^9}, {
  3.716581767165687*^9, 3.716581776576383*^9}, {3.716582209886394*^9, 
  3.71658223635781*^9}, {3.7165823037368593`*^9, 3.7165823040075493`*^9}, {
  3.71658241656485*^9, 3.716582425067586*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"l2", "+", 
       RowBox[{"s", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "lv11"}], "+", 
          RowBox[{"s", " ", "v2"}]}], ")"}]}], "-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["sigmaI", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"lw11", "-", 
            RowBox[{"s", " ", "vw11"}]}], ")"}], "2"]}], 
        RowBox[{
         SuperscriptBox["sigmaG", "2"], "+", 
         RowBox[{
          SuperscriptBox["sigmaI", "2"], " ", "w2"}]}]]}], 
      RowBox[{"2", " ", 
       SuperscriptBox["sigmaG", "2"]}]]}]], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"2", " ", "\[Pi]"}], ")"}], 
    RowBox[{
     RowBox[{"-", "n"}], "/", "2"}]], " ", 
   SuperscriptBox["sigmaG", 
    RowBox[{"1", "-", "n"}]]}], 
  SqrtBox[
   RowBox[{
    SuperscriptBox["sigmaG", "2"], "+", 
    RowBox[{
     SuperscriptBox["sigmaI", "2"], " ", "w2"}]}]]]], "Output",
 CellChangeTimes->{3.716581668656563*^9, 3.716581722333475*^9, 
  3.716581813963456*^9, 3.716582274887944*^9, 3.716582340412695*^9, 
  3.7165824774440536`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "check", " ", "if", " ", "it", " ", "simplifies", " ", "to", " ", 
    "correct", " ", "thing", " ", "in", " ", "one", " ", "neuron", " ", 
    "network"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"equation$9", "/.", 
           RowBox[{"l2", "\[Rule]", 
            RowBox[{"l1", "^", "2"}]}]}], "/.", 
          RowBox[{"lv11", "\[Rule]", 
           RowBox[{"l1", " ", "v1"}]}]}], "/.", 
         RowBox[{"lw11", "\[Rule]", 
          RowBox[{"l1", " ", "w1"}]}]}], "/.", 
        RowBox[{"w2", "\[Rule]", 
         RowBox[{"w1", "^", "2"}]}]}], "/.", 
       RowBox[{"v2", "\[Rule]", 
        RowBox[{"v1", "^", "2"}]}]}], "/.", 
      RowBox[{"vw11", "\[Rule]", 
       RowBox[{"v1", " ", "w1"}]}]}], "/.", 
     RowBox[{"n", "\[Rule]", "1"}]}], ",", " ", 
    RowBox[{"Assumptions", "\[Rule]", 
     RowBox[{"sigmaG", ">", "0"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.716581896468261*^9, 3.716581966773645*^9}, {
  3.716582376105482*^9, 3.716582388594741*^9}}],

Cell[BoxData[
 FractionBox[
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"-", 
    FractionBox[
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"l1", "-", 
        RowBox[{"s", " ", "v1"}]}], ")"}], "2"], 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["sigmaG", "2"], "+", 
        RowBox[{
         SuperscriptBox["sigmaI", "2"], " ", 
         SuperscriptBox["w1", "2"]}]}], ")"}]}]]}]], 
  RowBox[{
   SqrtBox[
    RowBox[{"2", " ", "\[Pi]"}]], " ", 
   SqrtBox[
    RowBox[{
     SuperscriptBox["sigmaG", "2"], "+", 
     RowBox[{
      SuperscriptBox["sigmaI", "2"], " ", 
      SuperscriptBox["w1", "2"]}]}]]}]]], "Output",
 CellChangeTimes->{{3.716581941490272*^9, 3.7165819675598*^9}, {
   3.716582370107836*^9, 3.716582389184803*^9}, 3.716582481137452*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"p$l$s", " ", "=", " ", "equation$9"}], "\[IndentingNewLine]", 
 RowBox[{"p$s", " ", "=", " ", 
  RowBox[{
   RowBox[{"1", "/", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"2", "Pi", " ", 
      RowBox[{"sigmaS", "^", "2"}]}], "]"}]}], " ", 
   RowBox[{"Exp", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"s", "^", "2"}]}], "/", 
     RowBox[{"(", 
      RowBox[{"2", " ", 
       RowBox[{"sigmaS", "^", "2"}]}], ")"}]}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.716582555649382*^9, 3.716582601759589*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"l2", "+", 
       RowBox[{"s", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "lv11"}], "+", 
          RowBox[{"s", " ", "v2"}]}], ")"}]}], "-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["sigmaI", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"lw11", "-", 
            RowBox[{"s", " ", "vw11"}]}], ")"}], "2"]}], 
        RowBox[{
         SuperscriptBox["sigmaG", "2"], "+", 
         RowBox[{
          SuperscriptBox["sigmaI", "2"], " ", "w2"}]}]]}], 
      RowBox[{"2", " ", 
       SuperscriptBox["sigmaG", "2"]}]]}]], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"2", " ", "\[Pi]"}], ")"}], 
    RowBox[{
     RowBox[{"-", "n"}], "/", "2"}]], " ", 
   SuperscriptBox["sigmaG", 
    RowBox[{"1", "-", "n"}]]}], 
  SqrtBox[
   RowBox[{
    SuperscriptBox["sigmaG", "2"], "+", 
    RowBox[{
     SuperscriptBox["sigmaI", "2"], " ", "w2"}]}]]]], "Output",
 CellChangeTimes->{{3.716582561096534*^9, 3.7165826024920588`*^9}}],

Cell[BoxData[
 FractionBox[
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"-", 
    FractionBox[
     SuperscriptBox["s", "2"], 
     RowBox[{"2", " ", 
      SuperscriptBox["sigmaS", "2"]}]]}]], 
  RowBox[{
   SqrtBox[
    RowBox[{"2", " ", "\[Pi]"}]], " ", 
   SqrtBox[
    SuperscriptBox["sigmaS", "2"]]}]]], "Output",
 CellChangeTimes->{{3.716582561096534*^9, 3.7165826025023317`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"equation", " ", "11"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"p$l", " ", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"Integrate", "[", 
     RowBox[{
      RowBox[{"p$l$s", " ", "p$s"}], ",", 
      RowBox[{"{", 
       RowBox[{"s", ",", 
        RowBox[{"-", "Infinity"}], ",", "Infinity"}], "}"}], ",", " ", 
      RowBox[{"Assumptions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"sigmaG", ">", "0"}], ",", " ", 
         RowBox[{"sigmaI", ">", "0"}], ",", " ", 
         RowBox[{"sigmaS", ">", "0"}], ",", " ", 
         RowBox[{"v2", ">", "0"}], ",", " ", 
         RowBox[{"w2", ">", "0"}], ",", " ", 
         RowBox[{
          RowBox[{"v2", " ", "w2"}], ">", " ", 
          RowBox[{"vw11", "^", "2"}]}]}], "}"}]}]}], "]"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.716582604020399*^9, 3.716582620234441*^9}, {
  3.7165826945155478`*^9, 3.716582715851178*^9}, {3.716582907377934*^9, 
  3.716582912489642*^9}, {3.716583292684389*^9, 3.7165833052755003`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     FractionBox[
      RowBox[{
       RowBox[{
        SuperscriptBox["lw11", "2"], " ", 
        SuperscriptBox["sigmaI", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["sigmaG", "2"], "+", 
          RowBox[{
           SuperscriptBox["sigmaS", "2"], " ", "v2"}]}], ")"}]}], "-", 
       RowBox[{"2", " ", "lv11", " ", "lw11", " ", 
        SuperscriptBox["sigmaI", "2"], " ", 
        SuperscriptBox["sigmaS", "2"], " ", "vw11"}], "+", 
       RowBox[{
        SuperscriptBox["lv11", "2"], " ", 
        SuperscriptBox["sigmaS", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["sigmaG", "2"], "+", 
          RowBox[{
           SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}]}], "-", 
       RowBox[{"l2", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["sigmaG", "4"], "+", 
          RowBox[{
           SuperscriptBox["sigmaG", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["sigmaS", "2"], " ", "v2"}], "+", 
             RowBox[{
              SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["sigmaI", "2"], " ", 
           SuperscriptBox["sigmaS", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox["vw11", "2"]}], "+", 
             RowBox[{"v2", " ", "w2"}]}], ")"}]}]}], ")"}]}]}], 
      RowBox[{"2", " ", 
       SuperscriptBox["sigmaG", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["sigmaG", "4"], "+", 
         RowBox[{
          SuperscriptBox["sigmaG", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["sigmaS", "2"], " ", "v2"}], "+", 
            RowBox[{
             SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["sigmaI", "2"], " ", 
          SuperscriptBox["sigmaS", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["vw11", "2"]}], "+", 
            RowBox[{"v2", " ", "w2"}]}], ")"}]}]}], ")"}]}]]], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"2", " ", "\[Pi]"}], ")"}], 
     RowBox[{
      RowBox[{"-", "n"}], "/", "2"}]], " ", 
    SuperscriptBox["sigmaG", 
     RowBox[{"2", "-", "n"}]]}], ")"}], "/", 
  RowBox[{"(", 
   SqrtBox[
    RowBox[{
     SuperscriptBox["sigmaG", "4"], "+", 
     RowBox[{
      SuperscriptBox["sigmaG", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["sigmaS", "2"], " ", "v2"}], "+", 
        RowBox[{
         SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["sigmaI", "2"], " ", 
      SuperscriptBox["sigmaS", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["vw11", "2"]}], "+", 
        RowBox[{"v2", " ", "w2"}]}], ")"}]}]}]], ")"}]}]], "Output",
 CellChangeTimes->{3.716582662363608*^9, 3.7165827672177362`*^9, 
  3.71658299531182*^9, 3.716583383220186*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"equation", " ", "15"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"kappa", " ", "=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Expand", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"sigmaG", "^", "2"}], " ", "+", " ", 
         RowBox[{
          RowBox[{"sigmaI", "^", "2"}], " ", "w2"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"sigmaG", "^", "2"}], " ", "+", " ", 
         RowBox[{
          RowBox[{"sigmaS", "^", "2"}], " ", "v2"}]}], ")"}]}], " ", "-", " ", 
      RowBox[{
       RowBox[{"sigmaI", "^", "2"}], " ", 
       RowBox[{"sigmaS", "^", "2"}], " ", 
       RowBox[{"vw11", "^", "2"}]}]}], "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7165828100914516`*^9, 3.7165828490867653`*^9}, {
  3.716583998207684*^9, 3.716583998311323*^9}}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["sigmaG", "4"], "+", 
  RowBox[{
   SuperscriptBox["sigmaG", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["sigmaS", "2"], " ", "v2"}], "+", 
     RowBox[{
      SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}]}], "+", 
  RowBox[{
   SuperscriptBox["sigmaI", "2"], " ", 
   SuperscriptBox["sigmaS", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["vw11", "2"]}], "+", 
     RowBox[{"v2", " ", "w2"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.716582836300861*^9, 3.716582850135159*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"equation", " ", "14"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"p$l", " ", "=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"p$l", "/.", 
      RowBox[{"kappa", "\[Rule]", "k"}]}], ",", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"sigmaG", ">", "0"}], ",", " ", 
        RowBox[{"sigmaI", ">", "0"}], ",", " ", 
        RowBox[{"sigmaS", ">", "0"}], ",", " ", 
        RowBox[{"k", ">", "0"}]}], "}"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.716583395564707*^9, 3.716583433303286*^9}, {
  3.716583804355167*^9, 3.716583804937881*^9}, {3.716583972520184*^9, 
  3.7165839726549053`*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"-", "k"}], " ", "l2"}], "+", 
      RowBox[{
       SuperscriptBox["lw11", "2"], " ", 
       SuperscriptBox["sigmaI", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["sigmaG", "2"], "+", 
         RowBox[{
          SuperscriptBox["sigmaS", "2"], " ", "v2"}]}], ")"}]}], "-", 
      RowBox[{"2", " ", "lv11", " ", "lw11", " ", 
       SuperscriptBox["sigmaI", "2"], " ", 
       SuperscriptBox["sigmaS", "2"], " ", "vw11"}], "+", 
      RowBox[{
       SuperscriptBox["lv11", "2"], " ", 
       SuperscriptBox["sigmaS", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["sigmaG", "2"], "+", 
         RowBox[{
          SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}]}]}], 
     RowBox[{"2", " ", "k", " ", 
      SuperscriptBox["sigmaG", "2"]}]]], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"2", " ", "\[Pi]"}], ")"}], 
    RowBox[{
     RowBox[{"-", "n"}], "/", "2"}]], " ", 
   SuperscriptBox["sigmaG", 
    RowBox[{"2", "-", "n"}]]}], 
  SqrtBox["k"]]], "Output",
 CellChangeTimes->{{3.7165834160146713`*^9, 3.71658343381735*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"sanity", " ", "check"}], ",", " ", 
    RowBox[{
     RowBox[{"p", "[", "l", "]"}], " ", "reduces", " ", "to", " ", "correct", 
     " ", "form", " ", "in", " ", "one", " ", "neuron", " ", "network"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"p$l", "/.", 
            RowBox[{"k", "\[Rule]", "kappa"}]}], "/.", 
           RowBox[{"l2", "\[Rule]", 
            RowBox[{"l1", "^", "2"}]}]}], "/.", 
          RowBox[{"lv11", "\[Rule]", 
           RowBox[{"l1", " ", "v1"}]}]}], "/.", 
         RowBox[{"lw11", "\[Rule]", 
          RowBox[{"l1", " ", "w1"}]}]}], "/.", 
        RowBox[{"w2", "\[Rule]", 
         RowBox[{"w1", "^", "2"}]}]}], "/.", 
       RowBox[{"v2", "\[Rule]", 
        RowBox[{"v1", "^", "2"}]}]}], "/.", 
      RowBox[{"vw11", "\[Rule]", 
       RowBox[{"v1", " ", "w1"}]}]}], "/.", 
     RowBox[{"n", "\[Rule]", "1"}]}], ",", " ", 
    RowBox[{"Assumptions", "\[Rule]", 
     RowBox[{"sigmaG", ">", "0"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.716583542499113*^9, 3.716583588859844*^9}, {
  3.716583731410812*^9, 3.716583778529801*^9}}],

Cell[BoxData[
 FractionBox[
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"-", 
    FractionBox[
     SuperscriptBox["l1", "2"], 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["sigmaG", "2"], "+", 
        RowBox[{
         SuperscriptBox["sigmaS", "2"], " ", 
         SuperscriptBox["v1", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["sigmaI", "2"], " ", 
         SuperscriptBox["w1", "2"]}]}], ")"}]}]]}]], 
  RowBox[{
   SqrtBox[
    RowBox[{"2", " ", "\[Pi]"}]], " ", 
   SqrtBox[
    RowBox[{
     SuperscriptBox["sigmaG", "2"], "+", 
     RowBox[{
      SuperscriptBox["sigmaS", "2"], " ", 
      SuperscriptBox["v1", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["sigmaI", "2"], " ", 
      SuperscriptBox["w1", "2"]}]}]]}]]], "Output",
 CellChangeTimes->{
  3.716583558237729*^9, 3.716583592724802*^9, {3.716583735193836*^9, 
   3.716583749690338*^9}, 3.71658378123394*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"equation$17", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"p$l$s", "/", "p$l"}], ",", " ", 
    RowBox[{"Assumptions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"sigmaG", ">", "0"}], ",", " ", 
       RowBox[{"sigmaI", ">", "0"}], ",", " ", 
       RowBox[{"sigmaS", ">", "0"}], ",", " ", 
       RowBox[{"k", ">", "0"}]}], "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.716584050300992*^9, 3.716584058361253*^9}, {
  3.716584382508088*^9, 3.716584383050602*^9}, {3.716584790015802*^9, 
  3.716584803369953*^9}, {3.716585352199894*^9, 3.71658535732646*^9}}],

Cell[BoxData[
 FractionBox[
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{"s", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "lv11"}], "+", 
         RowBox[{"s", " ", "v2"}]}], ")"}]}], "+", 
      FractionBox[
       RowBox[{
        SuperscriptBox["lw11", "2"], " ", 
        SuperscriptBox["sigmaI", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["sigmaG", "2"], "+", 
          RowBox[{
           SuperscriptBox["sigmaS", "2"], " ", "v2"}]}], ")"}]}], "k"], "-", 
      FractionBox[
       RowBox[{"2", " ", "lv11", " ", "lw11", " ", 
        SuperscriptBox["sigmaI", "2"], " ", 
        SuperscriptBox["sigmaS", "2"], " ", "vw11"}], "k"], "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["sigmaI", "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"lw11", "-", 
           RowBox[{"s", " ", "vw11"}]}], ")"}], "2"]}], 
       RowBox[{
        SuperscriptBox["sigmaG", "2"], "+", 
        RowBox[{
         SuperscriptBox["sigmaI", "2"], " ", "w2"}]}]], "+", 
      FractionBox[
       RowBox[{
        SuperscriptBox["lv11", "2"], " ", 
        SuperscriptBox["sigmaS", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["sigmaG", "2"], "+", 
          RowBox[{
           SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], ")"}]}], "k"]}], 
     RowBox[{"2", " ", 
      SuperscriptBox["sigmaG", "2"]}]]}]], 
  RowBox[{"sigmaG", " ", 
   SqrtBox[
    FractionBox[
     RowBox[{
      SuperscriptBox["sigmaG", "2"], "+", 
      RowBox[{
       SuperscriptBox["sigmaI", "2"], " ", "w2"}]}], "k"]]}]]], "Output",
 CellChangeTimes->{
  3.7165840591541967`*^9, {3.716584783909349*^9, 3.716584804780615*^9}, 
   3.716585358004636*^9}]
}, Open  ]]
},
WindowSize->{1080, 1875},
WindowMargins->{{Automatic, -1080}, {Automatic, -1}},
FrontEndVersion->"11.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 1199, 36, 75, "Input"],
Cell[1782, 60, 285, 9, 60, "Output"],
Cell[2070, 71, 554, 18, 73, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2661, 94, 675, 19, 75, "Input"],
Cell[3339, 115, 70, 1, 32, "Output"],
Cell[3412, 118, 70, 1, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3519, 124, 1845, 54, 75, "Input"],
Cell[5367, 180, 1165, 38, 51, "Output"],
Cell[6535, 220, 1057, 35, 51, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7629, 260, 1403, 35, 117, "Input"],
Cell[9035, 297, 1266, 40, 86, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10338, 342, 1186, 32, 75, "Input"],
Cell[11527, 376, 813, 26, 77, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12377, 407, 536, 15, 54, "Input"],
Cell[12916, 424, 1174, 38, 86, "Output"],
Cell[14093, 464, 391, 13, 73, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14521, 482, 1072, 26, 96, "Input"],
Cell[15596, 510, 3241, 95, 150, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18874, 610, 891, 24, 54, "Input"],
Cell[19768, 636, 599, 19, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20404, 660, 725, 18, 54, "Input"],
Cell[21132, 680, 1241, 37, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22410, 722, 1311, 36, 75, "Input"],
Cell[23724, 760, 935, 30, 76, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24696, 795, 619, 14, 32, "Input"],
Cell[25318, 811, 1833, 56, 106, "Output"]
}, Open  ]]
}
]
*)

